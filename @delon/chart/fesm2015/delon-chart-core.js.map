{"version":3,"file":"delon-chart-core.js","sources":["../../../../packages/chart/core/g2.servicce.ts"],"sourcesContent":["import { Injectable, OnDestroy } from '@angular/core';\nimport { AlainChartConfig, AlainConfigService, LazyService } from '@delon/util';\nimport { Observable, Subject } from 'rxjs';\n\n@Injectable({ providedIn: 'root' })\nexport class G2Service implements OnDestroy {\n  private _cog: AlainChartConfig;\n  private loading = false;\n  private loaded = false;\n  private notify$ = new Subject<void>();\n\n  get cog(): AlainChartConfig {\n    return this._cog;\n  }\n  set cog(val: AlainChartConfig) {\n    this._cog = this.cogSrv.merge(\n      'chart',\n      {\n        theme: '',\n        libs: [\n          'https://gw.alipayobjects.com/os/lib/antv/g2/4.1.4/dist/g2.min.js',\n          'https://gw.alipayobjects.com/os/lib/antv/data-set/0.11.7/dist/data-set.js',\n        ],\n      } as AlainChartConfig,\n      val,\n    )!;\n  }\n\n  constructor(private cogSrv: AlainConfigService, private lazySrv: LazyService) {\n    this.cog = { theme: '' };\n  }\n\n  libLoad(): this {\n    if (this.loading) {\n      if (this.loaded) {\n        this.notify$.next();\n      }\n      return this;\n    }\n    this.loading = true;\n    this.lazySrv.load(this.cog.libs!).then(() => {\n      this.loaded = true;\n      this.notify$.next();\n    });\n    return this;\n  }\n\n  get notify(): Observable<void> {\n    return this.notify$.asObservable();\n  }\n\n  ngOnDestroy(): void {\n    this.notify$.unsubscribe();\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;MAKa,SAAS;;;;;IAuBpB,YAAoB,MAA0B,EAAU,OAAoB;QAAxD,WAAM,GAAN,MAAM,CAAoB;QAAU,YAAO,GAAP,OAAO,CAAa;QArBpE,YAAO,GAAG,KAAK,CAAC;QAChB,WAAM,GAAG,KAAK,CAAC;QACf,YAAO,GAAG,IAAI,OAAO,EAAQ,CAAC;QAoBpC,IAAI,CAAC,GAAG,GAAG,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;KAC1B;;;;IAnBD,IAAI,GAAG;QACL,OAAO,IAAI,CAAC,IAAI,CAAC;KAClB;;;;;IACD,IAAI,GAAG,CAAC,GAAqB;QAC3B,IAAI,CAAC,IAAI,sBAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAC3B,OAAO,qBACP;YACE,KAAK,EAAE,EAAE;YACT,IAAI,EAAE;gBACJ,kEAAkE;gBAClE,2EAA2E;aAC5E;SACF,IACD,GAAG,CACJ,EAAC,CAAC;KACJ;;;;;;IAMD,OAAO;QACL,IAAI,mBAAA,IAAI,GAAC,OAAO,EAAE;YAChB,IAAI,mBAAA,IAAI,GAAC,MAAM,EAAE;gBACf,mBAAA,IAAI,GAAC,OAAO,CAAC,IAAI,EAAE,CAAC;aACrB;YACD,0BAAO,IAAI,GAAC;SACb;QACD,mBAAA,IAAI,GAAC,OAAO,GAAG,IAAI,CAAC;QACpB,mBAAA,IAAI,GAAC,OAAO,CAAC,IAAI,oBAAC,mBAAA,IAAI,GAAC,GAAG,CAAC,IAAI,GAAE,CAAC,IAAI;;;QAAC;YACrC,mBAAA,IAAI,GAAC,MAAM,GAAG,IAAI,CAAC;YACnB,mBAAA,IAAI,GAAC,OAAO,CAAC,IAAI,EAAE,CAAC;SACrB,EAAC,CAAC;QACH,0BAAO,IAAI,GAAC;KACb;;;;IAED,IAAI,MAAM;QACR,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,CAAC;KACpC;;;;IAED,WAAW;QACT,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;KAC5B;;;YAjDF,UAAU,SAAC,EAAE,UAAU,EAAE,MAAM,EAAE;;;;YAHP,kBAAkB;YAAE,WAAW;;;;;;;;IAKxD,yBAA+B;;;;;IAC/B,4BAAwB;;;;;IACxB,2BAAuB;;;;;IACvB,4BAAsC;;;;;IAmB1B,2BAAkC;;;;;IAAE,4BAA4B;;;;;;;;;;;;;;;;;"}