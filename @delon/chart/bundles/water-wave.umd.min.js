/**
 * @license ng-alain(cipchk@qq.com) v7.0.2
 * (c) 2019 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@angular/core"),require("@delon/util")):"function"==typeof define&&define.amd?define("@delon/chart/water-wave",["exports","rxjs","rxjs/operators","@angular/common","@angular/core","@delon/util"],t):t((e.delon=e.delon||{},e.delon.chart=e.delon.chart||{},e.delon.chart["water-wave"]={}),e.rxjs,e.rxjs.operators,e.ng.common,e.ng.core,e.delon.util)}(this,function(e,t,n,r,o,i){"use strict";function a(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(o=e[s])&&(a=(i<3?o(a):3<i?o(t,n,a):o(t,n))||a);return 3<i&&a&&Object.defineProperty(t,n,a),a}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)a.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=i["return"])&&n.call(i)}finally{if(o)throw o.error}}return a}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e}var h=function(){function e(e,t,n,r){this.el=e,this.renderer=t,this.ngZone=n,this.cdr=r,this.resize$=null,this.delay=0,this.color="#1890FF",this.height=160}return e.prototype.renderChart=function(t){if(this.resize$){var e=this,n=e.percent,c=e.color,r=e.node,o=Math.min(Math.max(n/100,0),100),i=this;cancelAnimationFrame(this.timer);var a=r.nativeElement,h=a.getContext("2d"),s=a.width,u=a.height,p=s/2,d=2,f=p-d;h.beginPath(),h.lineWidth=2*d;for(var g=s-d,v=g/8,y=.2,m=y,w=d,b=0,x=0,C=.005,I=[],M=p-d,l=-Math.PI/2,R=!0,j=l;j<l+2*Math.PI;j+=1/(8*Math.PI))I.push([p+M*Math.cos(j),p+M*Math.sin(j)]);var O=I.shift();h.strokeStyle=c,h.moveTo(O[0],O[1]),function P(){if(h.clearRect(0,0,s,u),R&&"update"!==t)if(I.length){var e=I.shift();h.lineTo(e[0],e[1]),h.stroke()}else R=!1,h.lineTo(O[0],O[1]),h.stroke(),I=null,h.globalCompositeOperation="destination-over",h.beginPath(),h.lineWidth=d,h.arc(p,p,M,0,2*Math.PI,!0),h.beginPath(),h.save(),h.arc(p,p,p-3*d,0,2*Math.PI,!0),h.restore(),h.clip(),h.fillStyle=c;else.85<=o?y/4<m&&(m-=.01*y):o<=.1?m<1.5*y&&(m+=.01*y):(m<=y&&(m+=.01*y),y<=m&&(m-=.01*y)),0<o-x&&(x+=C),o-x<0&&(x-=C),b+=.07,function l(){h.beginPath(),h.save();for(var e=[],t=w;t<=w+g;t+=20/g){var n=b+(w+t)/v,r=Math.sin(n)*m,o=t,i=2*f*(1-x)+(p-f)-v*r;h.lineTo(o,i),e.push([o,i])}var a=e.shift();h.lineTo(w+g,u),h.lineTo(w,u),h.lineTo(a[0],a[1]);var s=h.createLinearGradient(0,0,0,u);s.addColorStop(0,"#ffffff"),s.addColorStop(1,c),h.fillStyle=s,h.fill(),h.restore()}();i.timer=requestAnimationFrame(P)}()}},e.prototype.updateRadio=function(){var e=this.el.nativeElement.parentNode.offsetWidth,t=e<this.height?e/this.height:1;this.renderer.setStyle(this.el.nativeElement,"transform","scale("+t+")")},e.prototype.installResizeEvent=function(){var e=this;this.resize$=t.fromEvent(window,"resize").pipe(n.debounceTime(200)).subscribe(function(){return e.updateRadio()})},e.prototype.ngOnInit=function(){var e=this;this.updateRadio(),this.installResizeEvent(),this.ngZone.runOutsideAngular(function(){return setTimeout(function(){return e.renderChart("")},e.delay)})},e.prototype.ngOnChanges=function(){var e=this;this.ngZone.runOutsideAngular(function(){return e.renderChart("update")}),this.cdr.detectChanges()},e.prototype.ngOnDestroy=function(){this.timer&&cancelAnimationFrame(this.timer),this.resize$.unsubscribe()},e.decorators=[{type:o.Component,args:[{selector:"g2-water-wave",template:'<div [ngStyle]="{\'height.px\': height, \'width.px\': height, \'overflow\': \'hidden\'}">\n  <canvas #container class="g2-water-wave__canvas" width="{{height*2}}" height="{{height*2}}"></canvas>\n</div>\n<div class="g2-water-wave__desc" [ngStyle]="{\'width.px\': height}">\n  <span *ngIf="title" class="g2-water-wave__desc-title">\n    <ng-container *stringTemplateOutlet="title">{{title}}</ng-container>\n  </span>\n  <h4 class="g2-water-wave__desc-percent">{{percent}}%</h4>\n</div>\n',host:{"[class.g2-water-wave]":"true"},changeDetection:o.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:o.ElementRef},{type:o.Renderer2},{type:o.NgZone},{type:o.ChangeDetectorRef}]},e.propDecorators={node:[{type:o.ViewChild,args:["container"]}],delay:[{type:o.Input}],title:[{type:o.Input}],color:[{type:o.Input}],height:[{type:o.Input}],percent:[{type:o.Input}]},a([i.InputNumber(),s("design:type",Object)],e.prototype,"delay",void 0),a([i.InputNumber(),s("design:type",Object)],e.prototype,"height",void 0),a([i.InputNumber(),s("design:type",Number)],e.prototype,"percent",void 0),e}(),u=[h],p=function(){function e(){}return e.decorators=[{type:o.NgModule,args:[{imports:[r.CommonModule,i.DelonUtilModule],declarations:c(u),exports:c(u)}]}],e}();e.G2WaterWaveComponent=h,e.G2WaterWaveModule=p,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=water-wave.umd.min.js.map