{"version":3,"file":"delon-chart-core.umd.js","sources":["../../../../packages/chart/core/g2.servicce.ts"],"sourcesContent":["import { Injectable, OnDestroy } from '@angular/core';\nimport { AlainChartConfig, AlainConfigService, LazyService } from '@delon/util';\nimport { Observable, Subject } from 'rxjs';\n\n@Injectable({ providedIn: 'root' })\nexport class G2Service implements OnDestroy {\n  private _cog: AlainChartConfig;\n  private loading = false;\n  private loaded = false;\n  private notify$ = new Subject<void>();\n\n  get cog(): AlainChartConfig {\n    return this._cog;\n  }\n  set cog(val: AlainChartConfig) {\n    this._cog = this.cogSrv.merge(\n      'chart',\n      {\n        theme: '',\n        libs: [\n          'https://gw.alipayobjects.com/os/lib/antv/g2/4.1.4/dist/g2.min.js',\n          'https://gw.alipayobjects.com/os/lib/antv/data-set/0.11.7/dist/data-set.js',\n        ],\n      } as AlainChartConfig,\n      val,\n    )!;\n  }\n\n  constructor(private cogSrv: AlainConfigService, private lazySrv: LazyService) {\n    this.cog = { theme: '' };\n  }\n\n  libLoad(): this {\n    if (this.loading) {\n      if (this.loaded) {\n        this.notify$.next();\n      }\n      return this;\n    }\n    this.loading = true;\n    this.lazySrv.load(this.cog.libs!).then(() => {\n      this.loaded = true;\n      this.notify$.next();\n    });\n    return this;\n  }\n\n  get notify(): Observable<void> {\n    return this.notify$.asObservable();\n  }\n\n  ngOnDestroy(): void {\n    this.notify$.unsubscribe();\n  }\n}\n"],"names":["Subject","Injectable","AlainConfigService","LazyService"],"mappings":";;;;;;;;;;;;;;;;QA4BE,mBAAoB,MAA0B,EAAU,OAAoB;YAAxD,WAAM,GAAN,MAAM,CAAoB;YAAU,YAAO,GAAP,OAAO,CAAa;YArBpE,YAAO,GAAG,KAAK,CAAC;YAChB,WAAM,GAAG,KAAK,CAAC;YACf,YAAO,GAAG,IAAIA,YAAO,EAAQ,CAAC;YAoBpC,IAAI,CAAC,GAAG,GAAG,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;SAC1B;QAnBD,sBAAI,0BAAG;;;;iBAAP;gBACE,OAAO,IAAI,CAAC,IAAI,CAAC;aAClB;;;;;iBACD,UAAQ,GAAqB;gBAC3B,IAAI,CAAC,IAAI,sBAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAC3B,OAAO,qBACP;oBACE,KAAK,EAAE,EAAE;oBACT,IAAI,EAAE;wBACJ,kEAAkE;wBAClE,2EAA2E;qBAC5E;iBACF,IACD,GAAG,CACJ,EAAC,CAAC;aACJ;;;WAbA;;;;;;QAmBD,2BAAO,GAAP;YAAA,iBAaC;YAZC,IAAI,mBAAA,IAAI,GAAC,OAAO,EAAE;gBAChB,IAAI,mBAAA,IAAI,GAAC,MAAM,EAAE;oBACf,mBAAA,IAAI,GAAC,OAAO,CAAC,IAAI,EAAE,CAAC;iBACrB;gBACD,0BAAO,IAAI,GAAC;aACb;YACD,mBAAA,IAAI,GAAC,OAAO,GAAG,IAAI,CAAC;YACpB,mBAAA,IAAI,GAAC,OAAO,CAAC,IAAI,oBAAC,mBAAA,IAAI,GAAC,GAAG,CAAC,IAAI,GAAE,CAAC,IAAI;;eAAC;gBACrC,mBAAA,KAAI,GAAC,MAAM,GAAG,IAAI,CAAC;gBACnB,mBAAA,KAAI,GAAC,OAAO,CAAC,IAAI,EAAE,CAAC;aACrB,EAAC,CAAC;YACH,0BAAO,IAAI,GAAC;SACb;QAED,sBAAI,6BAAM;;;;iBAAV;gBACE,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,CAAC;aACpC;;;WAAA;;;;QAED,+BAAW,GAAX;YACE,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;SAC5B;;;;gBAjDFC,aAAU,SAAC,EAAE,UAAU,EAAE,MAAM,EAAE;;;;gBAHPC,qBAAkB;gBAAEC,cAAW;;;;;;;;QAKxD,yBAA+B;;;;;QAC/B,4BAAwB;;;;;QACxB,2BAAuB;;;;;QACvB,4BAAsC;;;;;QAmB1B,2BAAkC;;;;;QAAE,4BAA4B;;;;;;;;;;;;;;;;;"}