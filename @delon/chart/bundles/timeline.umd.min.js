/**
 * @license ng-alain(cipchk@qq.com) v11.3.1
 * (c) 2020 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@delon/chart/core"),require("@delon/util/date-time"),require("@delon/util/decorator"),require("date-fns/format"),require("ng-zorro-antd/core/outlet"),require("@angular/common"),require("ng-zorro-antd/skeleton")):"function"==typeof define&&define.amd?define("@delon/chart/timeline",["exports","@angular/core","@delon/chart/core","@delon/util/date-time","@delon/util/decorator","date-fns/format","ng-zorro-antd/core/outlet","@angular/common","ng-zorro-antd/skeleton"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).delon=e.delon||{},e.delon.chart=e.delon.chart||{},e.delon.chart.timeline={}),e.ng.core,e.delon.chart.core,e.dateTime,e.decorator,e.format,e["ng-zorro-antd/core/outlet"],e.ng.common,e.i3)}(this,(function(e,t,n,o,i,r,a,l,c){"use strict";function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var p=d(t),s=u(r),m=function(e,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function f(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function g(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}Object.create;function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}Object.create;var v=function(e){function n(){var n=e.apply(this,y(arguments))||this;return n.maxAxis=2,n.data=[],n.colorMap={y1:"#5B8FF9",y2:"#5AD8A6",y3:"#5D7092",y4:"#F6BD16",y5:"#E86452"},n.mask="HH:mm",n.maskSlider="HH:mm",n.position="top",n.height=450,n.padding=[40,8,64,40],n.borderWidth=2,n.slider=!0,n.clickItem=new t.EventEmitter,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(n,e),n.prototype.install=function(){var e=this,t=this,n=t.node,o=t.height,i=t.padding,r=t.slider,a=t.maxAxis,l=t.theme,c=t.maskSlider,u=this._chart=new window.G2.Chart({container:n.nativeElement,autoFit:!0,height:o,padding:i,theme:l});u.axis("time",{title:null}),u.axis("y1",{title:null});for(var d=2;d<=a;d++)u.axis("y"+d,!1);u.line().position("time*y1");for(d=2;d<=a;d++)u.line().position("time*y"+d);u.tooltip({showCrosshairs:!0,shared:!0}),Object.assign(Object.assign({},[]),i)[0]=0,r&&u.option("slider",{height:26,start:0,end:1,trendCfg:{isArea:!1},minLimit:2,formatter:function(e){return s.default(e,c)}}),u.on("plot:click",(function(t){var n=e._chart.getSnapRecords({x:t.x,y:t.y});e.ngZone.run((function(){return e.clickItem.emit({item:n[0]._origin,ev:t})}))})),u.on("legend-item:click",(function(e){var t,n=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.get("delegateObject").item,o=null==n?void 0:n.id,i=u.geometries.find((function(e){return e.getAttribute("position").getFields()[1]===o}));i&&i.changeVisible(!n.unchecked)})),this.attachChart()},n.prototype.attachChart=function(){var e=this,t=e._chart,n=e.height,i=e.padding,r=e.mask,a=e.titleMap,l=e.position,c=e.colorMap,u=e.borderWidth,d=e.maxAxis,p=y(this.data);if(t&&p&&!(p.length<=0)){var s=y(Array(d)).map((function(e,t){return t+1}));t.legend({position:l,custom:!0,items:s.map((function(e){var t="y"+e;return{id:t,name:a[t],value:t,marker:{style:{fill:c[t]}}}}))}),t.geometries.forEach((function(e,t){e.color(c["y"+(t+1)]).size(u)})),t.height=n,t.padding=i,p=p.map((function(e){return e.time=o.toDate(e.time),e._time=+e.time,e})).sort((function(e,t){return e._time-t._time}));var m=Math.max.apply(Math,y(s.map((function(e){return y(p).sort((function(t,n){return n["y"+e]-t["y"+e]}))[0]["y"+e]})))),f={};s.forEach((function(e){var t="y"+e;f[t]={alias:a[t],max:m,min:0}})),t.scale(Object.assign({time:{type:"time",mask:r,range:[0,1]}},f));var g=p[0]._time,h=p[p.length-1]._time,v=p.filter((function(e){return e._time>=g&&e._time<=h}));t.changeData(v),t.render()}},n}(n.G2BaseComponent);v.ɵfac=function(e){return b(e||v)},v.ɵcmp=t.ɵɵngDeclareComponent({version:"11.1.1",type:v,selector:"g2-timeline",inputs:{title:"title",maxAxis:"maxAxis",data:"data",titleMap:"titleMap",colorMap:"colorMap",mask:"mask",maskSlider:"maskSlider",position:"position",height:"height",padding:"padding",borderWidth:"borderWidth",slider:"slider"},outputs:{clickItem:"clickItem"},exportAs:["g2Timeline"],usesInheritance:!0,ngImport:p,template:'\n    <ng-container *nzStringTemplateOutlet="title">\n      <h4>{{ title }}</h4>\n    </ng-container>\n    <nz-skeleton *ngIf="!loaded"></nz-skeleton>\n    <div #container></div>\n  ',isInline:!0,directives:[{type:a.NzStringTemplateOutletDirective,selector:"[nzStringTemplateOutlet]",inputs:["nzStringTemplateOutletContext","nzStringTemplateOutlet"],exportAs:["nzStringTemplateOutlet"]},{type:l.NgIf,selector:"[ngIf]",inputs:["ngIf","ngIfThen","ngIfElse"]},{type:c.NzSkeletonComponent,selector:"nz-skeleton",inputs:["nzActive","nzLoading","nzRound","nzTitle","nzAvatar","nzParagraph"],exportAs:["nzSkeleton"]}],changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None}),f([i.InputNumber(),g("design:type",Object)],v.prototype,"maxAxis",void 0),f([i.InputNumber(),g("design:type",Object)],v.prototype,"height",void 0),f([i.InputNumber(),g("design:type",Object)],v.prototype,"borderWidth",void 0),f([i.InputBoolean(),g("design:type",Object)],v.prototype,"slider",void 0);var b=t.ɵɵgetInheritedFactory(v);("undefined"==typeof ngDevMode||ngDevMode)&&t.ɵsetClassMetadata(v,[{type:t.Component,args:[{selector:"g2-timeline",exportAs:"g2Timeline",template:'\n    <ng-container *nzStringTemplateOutlet="title">\n      <h4>{{ title }}</h4>\n    </ng-container>\n    <nz-skeleton *ngIf="!loaded"></nz-skeleton>\n    <div #container></div>\n  ',preserveWhitespaces:!1,changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None}]}],null,{title:[{type:t.Input}],maxAxis:[{type:t.Input}],data:[{type:t.Input}],titleMap:[{type:t.Input}],colorMap:[{type:t.Input}],mask:[{type:t.Input}],maskSlider:[{type:t.Input}],position:[{type:t.Input}],height:[{type:t.Input}],padding:[{type:t.Input}],borderWidth:[{type:t.Input}],slider:[{type:t.Input}],clickItem:[{type:t.Output}]});var O=[v],M=function(){};M.ɵmod=t.ɵɵdefineNgModule({type:M}),M.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||M)},imports:[[l.CommonModule,a.NzOutletModule,c.NzSkeletonModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(M,{declarations:[v],imports:[l.CommonModule,a.NzOutletModule,c.NzSkeletonModule],exports:[v]}),("undefined"==typeof ngDevMode||ngDevMode)&&t.ɵsetClassMetadata(M,[{type:t.NgModule,args:[{imports:[l.CommonModule,a.NzOutletModule,c.NzSkeletonModule],declarations:O,exports:O}]}],null,null),e.G2TimelineComponent=v,e.G2TimelineModule=M,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=timeline.umd.min.js.map