/**
 * @license ng-alain(cipchk@qq.com) v11.3.1
 * (c) 2020 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@delon/chart/core"),require("@delon/util"),require("date-fns/format"),require("ng-zorro-antd/core/outlet"),require("@angular/common"),require("ng-zorro-antd/skeleton")):"function"==typeof define&&define.amd?define("@delon/chart/timeline",["exports","@angular/core","@delon/chart/core","@delon/util","date-fns/format","ng-zorro-antd/core/outlet","@angular/common","ng-zorro-antd/skeleton"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).delon=e.delon||{},e.delon.chart=e.delon.chart||{},e.delon.chart.timeline={}),e.ng.core,e.delon.chart.core,e.delon.util,e.format,e["ng-zorro-antd/core/outlet"],e.ng.common,e.i3)}(this,(function(e,t,n,o,i,r,a,l){"use strict";function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function c(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var p=c(t),d=u(i),s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function f(e,t,n,o){var i,r=arguments.length,a=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(a=(r<3?i(a):r>3?i(t,n,a):i(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}Object.create;function g(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)a.push(o.value)}catch(e){i={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return a}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}Object.create;var y=function(e){function n(){var n=e.apply(this,h(arguments))||this;return n.maxAxis=2,n.data=[],n.colorMap={y1:"#5B8FF9",y2:"#5AD8A6",y3:"#5D7092",y4:"#F6BD16",y5:"#E86452"},n.mask="HH:mm",n.maskSlider="HH:mm",n.position="top",n.height=450,n.padding=[40,8,64,40],n.borderWidth=2,n.slider=!0,n.clickItem=new t.EventEmitter,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(n,e),n.prototype.install=function(){var e=this,t=this,n=t.node,o=t.height,i=t.padding,r=t.slider,a=t.maxAxis,l=t.theme,u=t.maskSlider,c=this._chart=new window.G2.Chart({container:n.nativeElement,autoFit:!0,height:o,padding:i,theme:l});c.axis("time",{title:null}),c.axis("y1",{title:null});for(var p=2;p<=a;p++)c.axis("y"+p,!1);c.line().position("time*y1");for(p=2;p<=a;p++)c.line().position("time*y"+p);c.tooltip({showCrosshairs:!0,shared:!0}),Object.assign(Object.assign({},[]),i)[0]=0,r&&c.option("slider",{height:26,start:0,end:1,trendCfg:{isArea:!1},minLimit:2,formatter:function(e){return d.default(e,u)}}),c.on("plot:click",(function(t){var n=e._chart.getSnapRecords({x:t.x,y:t.y});e.ngZone.run((function(){return e.clickItem.emit({item:n[0]._origin,ev:t})}))})),c.on("legend-item:click",(function(e){var t,n=null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.get("delegateObject").item,o=null==n?void 0:n.id,i=c.geometries.find((function(e){return e.getAttribute("position").getFields()[1]===o}));i&&i.changeVisible(!n.unchecked)})),this.attachChart()},n.prototype.attachChart=function(){var e=this,t=e._chart,n=e.height,i=e.padding,r=e.mask,a=e.titleMap,l=e.position,u=e.colorMap,c=e.borderWidth,p=e.maxAxis,d=h(this.data);if(t&&d&&!(d.length<=0)){var s=h(Array(p)).map((function(e,t){return t+1}));t.legend({position:l,custom:!0,items:s.map((function(e){var t="y"+e;return{id:t,name:a[t],value:t,marker:{style:{fill:u[t]}}}}))}),t.geometries.forEach((function(e,t){e.color(u["y"+(t+1)]).size(c)})),t.height=n,t.padding=i,d=d.map((function(e){return e.time=o.toDate(e.time),e._time=+e.time,e})).sort((function(e,t){return e._time-t._time}));var f=Math.max.apply(Math,h(s.map((function(e){return h(d).sort((function(t,n){return n["y"+e]-t["y"+e]}))[0]["y"+e]})))),m={};s.forEach((function(e){var t="y"+e;m[t]={alias:a[t],max:f,min:0}})),t.scale(Object.assign({time:{type:"time",mask:r,range:[0,1]}},m));var g=d[0]._time,y=d[d.length-1]._time,v=d.filter((function(e){return e._time>=g&&e._time<=y}));t.changeData(v),t.render()}},n}(n.G2BaseComponent);y.ɵfac=function(e){return v(e||y)},y.ɵcmp=t.ɵɵngDeclareComponent({version:"11.1.1",type:y,selector:"g2-timeline",inputs:{title:"title",maxAxis:"maxAxis",data:"data",titleMap:"titleMap",colorMap:"colorMap",mask:"mask",maskSlider:"maskSlider",position:"position",height:"height",padding:"padding",borderWidth:"borderWidth",slider:"slider"},outputs:{clickItem:"clickItem"},exportAs:["g2Timeline"],usesInheritance:!0,ngImport:p,template:'\n    <ng-container *nzStringTemplateOutlet="title">\n      <h4>{{ title }}</h4>\n    </ng-container>\n    <nz-skeleton *ngIf="!loaded"></nz-skeleton>\n    <div #container></div>\n  ',isInline:!0,directives:[{type:r.NzStringTemplateOutletDirective,selector:"[nzStringTemplateOutlet]",inputs:["nzStringTemplateOutletContext","nzStringTemplateOutlet"],exportAs:["nzStringTemplateOutlet"]},{type:a.NgIf,selector:"[ngIf]",inputs:["ngIf","ngIfThen","ngIfElse"]},{type:l.NzSkeletonComponent,selector:"nz-skeleton",inputs:["nzActive","nzLoading","nzRound","nzTitle","nzAvatar","nzParagraph"],exportAs:["nzSkeleton"]}],changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None}),f([o.InputNumber(),m("design:type",Object)],y.prototype,"maxAxis",void 0),f([o.InputNumber(),m("design:type",Object)],y.prototype,"height",void 0),f([o.InputNumber(),m("design:type",Object)],y.prototype,"borderWidth",void 0),f([o.InputBoolean(),m("design:type",Object)],y.prototype,"slider",void 0);var v=t.ɵɵgetInheritedFactory(y);("undefined"==typeof ngDevMode||ngDevMode)&&t.ɵsetClassMetadata(y,[{type:t.Component,args:[{selector:"g2-timeline",exportAs:"g2Timeline",template:'\n    <ng-container *nzStringTemplateOutlet="title">\n      <h4>{{ title }}</h4>\n    </ng-container>\n    <nz-skeleton *ngIf="!loaded"></nz-skeleton>\n    <div #container></div>\n  ',preserveWhitespaces:!1,changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None}]}],null,{title:[{type:t.Input}],maxAxis:[{type:t.Input}],data:[{type:t.Input}],titleMap:[{type:t.Input}],colorMap:[{type:t.Input}],mask:[{type:t.Input}],maskSlider:[{type:t.Input}],position:[{type:t.Input}],height:[{type:t.Input}],padding:[{type:t.Input}],borderWidth:[{type:t.Input}],slider:[{type:t.Input}],clickItem:[{type:t.Output}]});var b=[y],O=function(){};O.ɵmod=t.ɵɵdefineNgModule({type:O}),O.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||O)},imports:[[a.CommonModule,o.DelonUtilModule,r.NzOutletModule,l.NzSkeletonModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(O,{declarations:[y],imports:[a.CommonModule,o.DelonUtilModule,r.NzOutletModule,l.NzSkeletonModule],exports:[y]}),("undefined"==typeof ngDevMode||ngDevMode)&&t.ɵsetClassMetadata(O,[{type:t.NgModule,args:[{imports:[a.CommonModule,o.DelonUtilModule,r.NzOutletModule,l.NzSkeletonModule],declarations:b,exports:b}]}],null,null),e.G2TimelineComponent=y,e.G2TimelineModule=O,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=timeline.umd.min.js.map