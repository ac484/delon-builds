/**
 * @license ng-alain(cipchk@qq.com) v9.0.0-rc.2
 * (c) 2019 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@antv/g2"),require("@delon/util"),require("@angular/common"),require("ng-zorro-antd/core/outlet"),require("ng-zorro-antd/divider")):"function"==typeof define&&define.amd?define("@delon/chart/pie",["exports","@angular/core","@antv/g2","@delon/util","@angular/common","ng-zorro-antd/core/outlet","ng-zorro-antd/divider"],t):t(((e=e||self).delon=e.delon||{},e.delon.chart=e.delon.chart||{},e.delon.chart.pie={}),e.ng.core,e.g2,e.delon.util,e.ng.common,e["ng-zorro-antd/core/outlet"],e["ng-zorro-antd/divider"])}(this,(function(e,t,n,i,o,r,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function l(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function d(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e}var u=function(){function e(e,t,n){this.el=e,this.ngZone=t,this.cdr=n,this.legendData=[],this.delay=0,this.animate=!0,this.color="rgba(24, 144, 255, 0.85)",this.height=0,this.hasLegend=!1,this.inner=.75,this.padding=[12,0,12,0],this.tooltip=!0,this.lineWidth=0,this.blockMaxWidth=380,this.select=!0,this.data=[],this.interaction="none"}return Object.defineProperty(e.prototype,"block",{get:function(){return this.hasLegend&&this.el.nativeElement.clientWidth<=this.blockMaxWidth},enumerable:!0,configurable:!0}),e.prototype.fixData=function(){var e=this.percent,t=this.color;this.isPercent=null!=e,this.isPercent&&(this.select=!1,this.tooltip=!1,this.percentColor=function(e){return"占比"===e?t||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},this.data=[{x:"占比",y:e},{x:"反比",y:100-e}])},e.prototype.install=function(){var e=this,t=e.node,i=e.height,o=e.padding,r=e.tooltip,a=e.inner,l=e.hasLegend,c=e.interaction,p=this.chart=new n.Chart({container:t.nativeElement,autoFit:!0,height:i,padding:o});r?p.tooltip({showTitle:!1,showMarkers:!1}):p.tooltip(!1),"none"!==c&&p.interaction(c),p.axis(!1).legend(!1).coordinate("theta",{innerRadius:a}),p.filter("x",(function(e,t){return!1!==t.checked})),p.interval().adjust("stack").position("y").tooltip("x*percent",(function(e,t){return{name:e,value:(l?t:(100*t).toFixed(2))+" %"}})).state({}),this.attachChart()},e.prototype.attachChart=function(){var e,t,n=this,i=this,o=i.chart,r=i.height,a=i.padding,l=i.animate,c=i.data,s=i.lineWidth,d=i.isPercent,u=i.percentColor,h=i.colors;if(o){o.height=r,o.padding=a,o.animate(l),o.geometries[0].style({lineWidth:s,stroke:"#fff"}).color("x",d?u:h),o.scale({x:{type:"cat",range:[0,1]}});var g=c.reduce((function(e,t){return e+t.y}),0);try{for(var y=p(c),f=y.next();!f.done;f=y.next()){var v=f.value;v.percent=0===g?0:v.y/g}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=y.return)&&t.call(y)}finally{if(e)throw e.error}}o.changeData(c),this.ngZone.run((function(){return n.genLegend()}))}},e.prototype.genLegend=function(){var e=this.hasLegend,t=this.isPercent,n=this.cdr,i=this.chart;e&&!t&&(this.legendData=i.geometries[0].dataArray.map((function(e){var t=e[0]._origin;return t.color=e[0].color,t.checked=!0,t.percent=(100*t.percent).toFixed(2),t})),n.detectChanges())},e.prototype._click=function(e){var t=this.legendData,n=this.chart;t[e].checked=!t[e].checked,n.render()},e.prototype.ngOnInit=function(){var e=this;this.ngZone.runOutsideAngular((function(){return setTimeout((function(){return e.install()}),e.delay)}))},e.prototype.ngOnChanges=function(){var e=this;this.fixData(),this.ngZone.runOutsideAngular((function(){return e.attachChart()}))},e.prototype.ngOnDestroy=function(){var e=this;this.chart&&this.ngZone.runOutsideAngular((function(){return e.chart.destroy()}))},e.decorators=[{type:t.Component,args:[{selector:"g2-pie",exportAs:"g2Pie",template:'<div class="g2-pie__chart">\n  <div #container></div>\n  <div *ngIf="subTitle || total"\n       class="g2-pie__total">\n    <h4 *ngIf="subTitle"\n        class="g2-pie__total-title">\n      <ng-container *nzStringTemplateOutlet="subTitle">\n        <div [innerHTML]="subTitle"></div>\n      </ng-container>\n    </h4>\n    <div *ngIf="total" class="g2-pie__total-stat">\n      <ng-container *nzStringTemplateOutlet="total">\n        <div [innerHTML]="total"></div>\n      </ng-container>\n    </div>\n  </div>\n</div>\n<ul *ngIf="hasLegend && legendData?.length"\n    class="g2-pie__legend">\n  <li *ngFor="let item of legendData; let index = index" (click)="_click(index)" class="g2-pie__legend-item">\n    <span class="g2-pie__legend-dot" [ngStyle]="{\'background-color\': !item.checked ? \'#aaa\' : item.color}"></span>\n    <span class="g2-pie__legend-title">{{item.x}}</span>\n    <nz-divider nzType="vertical"></nz-divider>\n    <span class="g2-pie__legend-percent">{{item.percent}}%</span>\n    <span class="g2-pie__legend-value" [innerHTML]="valueFormat ? valueFormat(item.y) : item.y"></span>\n  </li>\n</ul>\n',host:{"[class.g2-pie]":"true","[class.g2-pie__legend-has]":"hasLegend","[class.g2-pie__legend-block]":"block","[class.g2-pie__mini]":"isPercent"},preserveWhitespaces:!1,changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None}]}],e.ctorParameters=function(){return[{type:t.ElementRef},{type:t.NgZone},{type:t.ChangeDetectorRef}]},e.propDecorators={node:[{type:t.ViewChild,args:["container",{static:!0}]}],delay:[{type:t.Input}],animate:[{type:t.Input}],color:[{type:t.Input}],subTitle:[{type:t.Input}],total:[{type:t.Input}],height:[{type:t.Input}],hasLegend:[{type:t.Input}],inner:[{type:t.Input}],padding:[{type:t.Input}],percent:[{type:t.Input}],tooltip:[{type:t.Input}],lineWidth:[{type:t.Input}],blockMaxWidth:[{type:t.Input}],select:[{type:t.Input}],valueFormat:[{type:t.Input}],data:[{type:t.Input}],colors:[{type:t.Input}],interaction:[{type:t.Input}]},l([i.InputNumber(),c("design:type",Object)],e.prototype,"delay",void 0),l([i.InputBoolean(),c("design:type",Object)],e.prototype,"animate",void 0),l([i.InputNumber(),c("design:type",Object)],e.prototype,"height",void 0),l([i.InputBoolean(),c("design:type",Object)],e.prototype,"hasLegend",void 0),l([i.InputNumber(),c("design:type",Number)],e.prototype,"percent",void 0),l([i.InputBoolean(),c("design:type",Object)],e.prototype,"tooltip",void 0),l([i.InputNumber(),c("design:type",Object)],e.prototype,"lineWidth",void 0),l([i.InputNumber(),c("design:type",Object)],e.prototype,"blockMaxWidth",void 0),l([i.InputBoolean(),c("design:type",Object)],e.prototype,"select",void 0),e}();var h=[u],g=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[o.CommonModule,i.DelonUtilModule,a.NzDividerModule,r.NzOutletModule],declarations:d(h),exports:d(h)}]}],e}();e.G2PieComponent=u,e.G2PieModule=g,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=pie.umd.min.js.map