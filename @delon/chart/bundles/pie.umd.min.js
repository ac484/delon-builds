/**
 * @license ng-alain(cipchk@qq.com) v2.0.0-beta.3-ed90aa6
 * (c) 2018 Cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@delon/util"),require("@angular/common"),require("ng-zorro-antd")):"function"==typeof define&&define.amd?define("@delon/chart/pie",["exports","@angular/core","rxjs","rxjs/operators","@delon/util","@angular/common","ng-zorro-antd"],t):t((e.delon=e.delon||{},e.delon.chart=e.delon.chart||{},e.delon.chart.pie={}),e.ng.core,e.rxjs,e.rxjs.operators,e.delon.util,e.ng.common,e.ngZorro.antd)}(this,function(e,t,n,i,r,o,s){"use strict";var a=function(){function e(e,t,n,i){this.el=e,this.rend=t,this.cd=n,this.zone=i,this.scroll$=null,this.initFlag=!1,this.legendData=[],this._animate=!0,this.color="rgba(24, 144, 255, 0.85)",this._height=0,this._hasLegend=!1,this._legendBlock=!1,this.inner=.75,this.padding=[12,0,12,0],this._tooltip=!0,this._lineWidth=0,this._select=!0}return Object.defineProperty(e.prototype,"animate",{set:function(e){this._animate=r.toBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(e){this._height=r.toNumber(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasLegend",{get:function(){return this._hasLegend},set:function(e){this._hasLegend=r.toBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"legendBlock",{set:function(e){this._legendBlock=r.toBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"percent",{get:function(){return this._percent},set:function(e){this._percent=r.toNumber(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tooltip",{get:function(){return this._tooltip},set:function(e){this._tooltip=r.toBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(e){this._lineWidth=r.toNumber(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"select",{get:function(){return this._select},set:function(e){this._select=r.toBoolean(e)},enumerable:!0,configurable:!0}),e.prototype.setCls=function(){r.updateHostClass(this.el.nativeElement,this.rend,{"g2-pie":!0,"g2-pie__legend-has":this.hasLegend,"g2-pie__legend-block":this._legendBlock,"g2-pie__mini":"undefined"!=typeof this.percent},!0)},e.prototype.runInstall=function(){var e=this;this.zone.runOutsideAngular(function(){return setTimeout(function(){return e.install()})})},e.prototype.install=function(){var e,n=this;this.legendBlock=this.el.nativeElement.clientWidth<=380,this.setCls();var t="undefined"!=typeof this.percent;if(t&&(this.select=!1,this.tooltip=!1,e=function(e){return"占比"===e?n.color||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},this.data=[{x:"占比",y:this.percent},{x:"反比",y:100-this.percent}]),this.data&&!(this.data&&this.data.length<1)){this.chart&&this.chart.destroy(),this.node.nativeElement.innerHTML="";var i=new G2.Chart({container:this.node.nativeElement,forceFit:!0,height:this.height,padding:this.padding,animate:this._animate});this.tooltip?i.tooltip({showTitle:!1,itemTpl:'<li><span style="background-color:{color};" class="g2-tooltip-marker"></span>{name}: {value} %</li>'}):i.tooltip(!1),i.axis(!1),i.legend(!1);var r=new DataSet.DataView;r.source(this.data).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),i.source(r,{x:{type:"cat",range:[0,1]},y:{min:0}}),i.coord("theta",{innerRadius:this.inner}),i.intervalStack().position("y").style({lineWidth:this.lineWidth,stroke:"#fff"}).tooltip("x*percent",function(e,t){return{name:e,value:n.hasLegend?t:(100*t).toFixed(2)}}).color("x",t?e:this.colors).select(this.select),i.render(),this.chart=i,this.hasLegend&&this.zone.run(function(){n.legendData=i.getAllGeoms()[0]._attrs.dataArray.map(function(e){var t=e[0]._origin;return t.color=e[0].color,t.checked=!0,t.percent=(100*t.percent).toFixed(2),t}),n.cd.detectChanges()})}},e.prototype.installResizeEvent=function(){var e=this;!this.scroll$&&this.hasLegend&&(this.scroll$=n.fromEvent(window,"resize").pipe(i.debounceTime(200)).subscribe(function(){return e.runInstall()}))},e.prototype._click=function(e){this.legendData[e].checked=!this.legendData[e].checked,this.chart&&(this.chart.filter("x",function(e,t){return t.checked}),this.chart.repaint())},e.prototype.ngAfterViewInit=function(){this.initFlag=!0,this.runInstall()},e.prototype.ngOnChanges=function(){this.installResizeEvent(),this.initFlag&&this.runInstall()},e.prototype.ngOnDestroy=function(){this.scroll$&&this.scroll$.unsubscribe(),this.chart&&(this.chart.destroy(),this.chart=null)},e.decorators=[{type:t.Component,args:[{selector:"g2-pie",template:'<div class="g2-pie__chart">\r\n  <div #container></div>\r\n  <div *ngIf="subTitle || total" class="g2-pie__total">\r\n    <h4 *ngIf="subTitle" class="g2-pie__total-title" [innerHTML]="subTitle"></h4>\r\n    <div *ngIf="total" class="g2-pie__total-stat" [innerHTML]="total"></div>\r\n  </div>\r\n</div>\r\n<ul *ngIf="hasLegend && legendData?.length" class="g2-pie__legend">\r\n  <li *ngFor="let item of legendData; let index = index" (click)="_click(index)" class="g2-pie__legend-item">\r\n    <span class="g2-pie__legend-dot" [ngStyle]="{\'background-color\': !item.checked ? \'#aaa\' : item.color}"></span>\r\n    <span class="g2-pie__legend-title">{{item.x}}</span>\r\n    <nz-divider nzType="vertical"></nz-divider>\r\n    <span class="g2-pie__legend-percent">{{item.percent}}%</span>\r\n    <span class="g2-pie__legend-value" [innerHTML]="valueFormat ? valueFormat(item.y) : item.y"></span>\r\n  </li>\r\n</ul>\r\n',changeDetection:t.ChangeDetectionStrategy.OnPush,preserveWhitespaces:!1}]}],e.ctorParameters=function(){return[{type:t.ElementRef},{type:t.Renderer2},{type:t.ChangeDetectorRef},{type:t.NgZone}]},e.propDecorators={node:[{type:t.ViewChild,args:["container"]}],animate:[{type:t.Input}],color:[{type:t.Input}],subTitle:[{type:t.Input}],total:[{type:t.Input}],height:[{type:t.Input}],hasLegend:[{type:t.Input}],legendBlock:[{type:t.Input}],inner:[{type:t.Input}],padding:[{type:t.Input}],percent:[{type:t.Input}],tooltip:[{type:t.Input}],lineWidth:[{type:t.Input}],select:[{type:t.Input}],data:[{type:t.Input}],valueFormat:[{type:t.Input}],colors:[{type:t.Input}]},e}();function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(i=o.next()).done;)s.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o["return"])&&n.call(o)}finally{if(r)throw r.error}}return s}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e}var p=[a],u=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[]}},e.decorators=[{type:t.NgModule,args:[{imports:[o.CommonModule,r.DelonUtilModule,s.NgZorroAntdModule],declarations:c(p),exports:c(p)}]}],e}();e.G2PieComponent=a,e.G2PieModule=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=pie.umd.min.js.map