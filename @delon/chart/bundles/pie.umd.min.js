/**
 * @license ng-alain(cipchk@qq.com) v2.0.1
 * (c) 2018 Cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@angular/core"),require("@delon/util"),require("ng-zorro-antd")):"function"==typeof define&&define.amd?define("@delon/chart/pie",["exports","rxjs","rxjs/operators","@angular/common","@angular/core","@delon/util","ng-zorro-antd"],t):t((e.delon=e.delon||{},e.delon.chart=e.delon.chart||{},e.delon.chart.pie={}),e.rxjs,e.rxjs.operators,e.ng.common,e.ng.core,e.delon.util,e.ngZorro.antd)}(this,function(e,t,n,i,o,r,a){"use strict";function l(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;0<=l;l--)(o=e[l])&&(a=(r<3?o(a):3<r?o(t,n,a):o(t,n))||a);return 3<r&&a&&Object.defineProperty(t,n,a),a}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,r=n.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(i=r.next()).done;)a.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(n=r["return"])&&n.call(r)}finally{if(o)throw o.error}}return a}function p(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}var d=function(){function e(e,t,n,i){this.el=e,this.rend=t,this.cd=n,this.zone=i,this.scroll$=null,this.initFlag=!1,this.legendData=[],this.animate=!0,this.color="rgba(24, 144, 255, 0.85)",this.height=0,this.hasLegend=!1,this.legendBlock=!1,this.inner=.75,this.padding=[12,0,12,0],this.tooltip=!0,this.lineWidth=0,this.select=!0}return e.prototype.setCls=function(){r.updateHostClass(this.el.nativeElement,this.rend,{"g2-pie":!0,"g2-pie__legend-has":this.hasLegend,"g2-pie__legend-block":this.legendBlock,"g2-pie__mini":"undefined"!=typeof this.percent},!0)},e.prototype.runInstall=function(){var e=this;this.zone.runOutsideAngular(function(){return setTimeout(function(){return e.install()})})},e.prototype.install=function(){var e,n=this;this.legendBlock=this.el.nativeElement.clientWidth<=380,this.setCls();var t="undefined"!=typeof this.percent;if(t&&(this.select=!1,this.tooltip=!1,e=function(e){return"占比"===e?n.color||"rgba(24, 144, 255, 0.85)":"#F0F2F5"},this.data=[{x:"占比",y:this.percent},{x:"反比",y:100-this.percent}]),this.data&&!(this.data&&this.data.length<1)){this.chart&&this.chart.destroy(),this.node.nativeElement.innerHTML="";var i=new G2.Chart({container:this.node.nativeElement,forceFit:!0,height:this.height,padding:this.padding,animate:this.animate});this.tooltip?i.tooltip({showTitle:!1,itemTpl:'<li><span style="background-color:{color};" class="g2-tooltip-marker"></span>{name}: {value} %</li>'}):i.tooltip(!1),i.axis(!1),i.legend(!1);var o=new DataSet.DataView;o.source(this.data).transform({type:"percent",field:"y",dimension:"x",as:"percent"}),i.source(o,{x:{type:"cat",range:[0,1]},y:{min:0}}),i.coord("theta",{innerRadius:this.inner}),i.intervalStack().position("y").style({lineWidth:this.lineWidth,stroke:"#fff"}).tooltip("x*percent",function(e,t){return{name:e,value:n.hasLegend?t:(100*t).toFixed(2)}}).color("x",t?e:this.colors).select(this.select),i.render(),this.chart=i,this.hasLegend&&this.zone.run(function(){n.legendData=i.getAllGeoms()[0]._attrs.dataArray.map(function(e){var t=e[0]._origin;return t.color=e[0].color,t.checked=!0,t.percent=(100*t.percent).toFixed(2),t}),n.cd.detectChanges()})}},e.prototype.installResizeEvent=function(){var e=this;!this.scroll$&&this.hasLegend&&(this.scroll$=t.fromEvent(window,"resize").pipe(n.debounceTime(200)).subscribe(function(){return e.runInstall()}))},e.prototype._click=function(e){this.legendData[e].checked=!this.legendData[e].checked,this.chart&&(this.chart.filter("x",function(e,t){return t.checked}),this.chart.repaint())},e.prototype.ngAfterViewInit=function(){this.initFlag=!0,this.runInstall()},e.prototype.ngOnChanges=function(){this.installResizeEvent(),this.initFlag&&this.runInstall()},e.prototype.ngOnDestroy=function(){this.scroll$&&this.scroll$.unsubscribe(),this.chart&&(this.chart.destroy(),this.chart=null)},e.decorators=[{type:o.Component,args:[{selector:"g2-pie",template:'<div class="g2-pie__chart">\n  <div #container></div>\n  <div *ngIf="subTitle || total" class="g2-pie__total">\n    <h4 *ngIf="subTitle" class="g2-pie__total-title" [innerHTML]="subTitle"></h4>\n    <div *ngIf="total" class="g2-pie__total-stat" [innerHTML]="total"></div>\n  </div>\n</div>\n<ul *ngIf="hasLegend && legendData?.length" class="g2-pie__legend">\n  <li *ngFor="let item of legendData; let index = index" (click)="_click(index)" class="g2-pie__legend-item">\n    <span class="g2-pie__legend-dot" [ngStyle]="{\'background-color\': !item.checked ? \'#aaa\' : item.color}"></span>\n    <span class="g2-pie__legend-title">{{item.x}}</span>\n    <nz-divider nzType="vertical"></nz-divider>\n    <span class="g2-pie__legend-percent">{{item.percent}}%</span>\n    <span class="g2-pie__legend-value" [innerHTML]="valueFormat ? valueFormat(item.y) : item.y"></span>\n  </li>\n</ul>\n',changeDetection:o.ChangeDetectionStrategy.OnPush}]}],e.ctorParameters=function(){return[{type:o.ElementRef},{type:o.Renderer2},{type:o.ChangeDetectorRef},{type:o.NgZone}]},e.propDecorators={node:[{type:o.ViewChild,args:["container"]}],animate:[{type:o.Input}],color:[{type:o.Input}],subTitle:[{type:o.Input}],total:[{type:o.Input}],height:[{type:o.Input}],hasLegend:[{type:o.Input}],legendBlock:[{type:o.Input}],inner:[{type:o.Input}],padding:[{type:o.Input}],percent:[{type:o.Input}],tooltip:[{type:o.Input}],lineWidth:[{type:o.Input}],select:[{type:o.Input}],data:[{type:o.Input}],valueFormat:[{type:o.Input}],colors:[{type:o.Input}]},l([r.InputBoolean(),s("design:type",Object)],e.prototype,"animate",void 0),l([r.InputNumber(),s("design:type",Object)],e.prototype,"height",void 0),l([r.InputBoolean(),s("design:type",Object)],e.prototype,"hasLegend",void 0),l([r.InputBoolean(),s("design:type",Object)],e.prototype,"legendBlock",void 0),l([r.InputNumber(),s("design:type",Number)],e.prototype,"percent",void 0),l([r.InputBoolean(),s("design:type",Object)],e.prototype,"tooltip",void 0),l([r.InputNumber(),s("design:type",Object)],e.prototype,"lineWidth",void 0),l([r.InputBoolean(),s("design:type",Object)],e.prototype,"select",void 0),e}(),u=[d],h=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[]}},e.decorators=[{type:o.NgModule,args:[{imports:[i.CommonModule,r.DelonUtilModule,a.NgZorroAntdModule],declarations:p(u),exports:p(u)}]}],e}();e.G2PieComponent=d,e.G2PieModule=h,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=pie.umd.min.js.map