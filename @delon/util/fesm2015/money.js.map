{"version":3,"file":"money.js","sources":["../../../../packages/util/format/string.ts","../../../../packages/util/format/validate.ts","../../../../packages/util/format/number.ts"],"sourcesContent":["import { deepGet } from '@delon/util/other';\nimport { NzSafeAny } from 'ng-zorro-antd/core/types';\n\n/**\n * 字符串格式化\n * ```\n * format('this is ${name}', { name: 'asdf' })\n * // output: this is asdf\n * format('this is ${user.name}', { user: { name: 'asdf' } }, true)\n * // output: this is asdf\n * ```\n */\nexport function format(str: string | null | undefined, obj: NzSafeAny | null | undefined, needDeepGet: boolean = false): string {\n  return (str || '').replace(/\\${([^}]+)}/g, (_work: string, key: string) =>\n    needDeepGet ? deepGet(obj, key.split('.'), '') : (obj || {})[key] || '',\n  );\n}\n","export const REGEX = {\n  num: /^((-?\\d+\\.\\d+)|(-?\\d+)|(-?\\.\\d+))$/,\n  idCard: /(^\\d{15}$)|(^\\d{17}([0-9]|X)$)/i,\n  mobile: /^(0|\\+?86|17951)?(13[0-9]|15[0-9]|17[0678]|18[0-9]|14[57])[0-9]{8}$/,\n  url: /(((^https?:(?:\\/\\/)?)(?:[-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9.-]+(?::\\d+)?|(?:www.|[-;:&=\\+\\$,\\w]+@)[A-Za-z0-9.-]+)((?:\\/[\\+~%\\/.\\w-_]*)?\\??(?:[-\\+=&;%@.\\w_]*)#?(?:[\\w]*))?)$/,\n  ip: /(?:^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$)|(?:^(?:(?:[a-fA-F\\d]{1,4}:){7}(?:[a-fA-F\\d]{1,4}|:)|(?:[a-fA-F\\d]{1,4}:){6}(?:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|:[a-fA-F\\d]{1,4}|:)|(?:[a-fA-F\\d]{1,4}:){5}(?::(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,2}|:)|(?:[a-fA-F\\d]{1,4}:){4}(?:(?::[a-fA-F\\d]{1,4}){0,1}:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,3}|:)|(?:[a-fA-F\\d]{1,4}:){3}(?:(?::[a-fA-F\\d]{1,4}){0,2}:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,4}|:)|(?:[a-fA-F\\d]{1,4}:){2}(?:(?::[a-fA-F\\d]{1,4}){0,3}:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,5}|:)|(?:[a-fA-F\\d]{1,4}:){1}(?:(?::[a-fA-F\\d]{1,4}){0,4}:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,6}|:)|(?::(?:(?::[a-fA-F\\d]{1,4}){0,5}:(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}|(?::[a-fA-F\\d]{1,4}){1,7}|:)))(?:%[0-9a-zA-Z]{1,})?$)/,\n  color: /^(?:#|0x)(?:[a-f0-9]{3}|[a-f0-9]{6})\\b|(?:rgb|hsl)a?\\([^\\)]*\\)$/,\n};\n\n/**\n * Wheter is number\n *\n * 是否为数字\n */\nexport function isNum(value: string | number): boolean {\n  return REGEX.num.test(value.toString());\n}\n\n/**\n * Wheter is integer\n *\n * 是否为整数\n */\nexport function isInt(value: string | number): boolean {\n  return isNum(value) && parseInt(value.toString(), 10).toString() === value.toString();\n}\n\n/**\n * Wheter is decimal\n *\n * 是否为小数点数值\n */\nexport function isDecimal(value: string | number): boolean {\n  return isNum(value) && !isInt(value);\n}\n\n/**\n * Wheter is People's Republic of China identity card\n *\n * 是否为中华人民共和国居民身份证\n */\nexport function isIdCard(value: string): boolean {\n  return REGEX.idCard.test(value);\n}\n\n/**\n * Wheter is china mobile (China)\n *\n * 是否为手机号（中国）\n */\nexport function isMobile(value: string): boolean {\n  return REGEX.mobile.test(value);\n}\n\n/**\n * Wheter is url address\n *\n * 是否URL地址\n */\nexport function isUrl(url: string): boolean {\n  return REGEX.url.test(url);\n}\n\n/**\n * Wheter is IPv4 address (Support v4, v6)\n *\n * 是否IP4地址（支持v4、v6）\n */\nexport function isIp(ip: string): boolean {\n  return REGEX.ip.test(ip);\n}\n\n/**\n * Wheter is color\n *\n * 是否颜色代码值\n */\nexport function isColor(color: string): boolean {\n  return REGEX.color.test(color);\n}\n","/**\n * Format a number with commas as thousands separators\n *\n * 用逗号将数字格式化为千位分隔符\n * ```ts\n * 10000 => `10,000`\n * ```\n */\nexport function commasNumber(value: number | string, separator: string = ','): string {\n  return value.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, separator);\n}\n\nexport const MEGA_POWERS = [\n  { unit: 'Q', value: Math.pow(10, 15) },\n  { unit: 'T', value: Math.pow(10, 12) },\n  { unit: 'B', value: Math.pow(10, 9) },\n  { unit: 'M', value: Math.pow(10, 6) },\n  { unit: 'K', value: 1000 },\n];\n\nexport interface MegaNumberUnitI18n {\n  Q: string;\n  T: string;\n  B: string;\n  M: string;\n  K: string;\n}\n\nexport interface MegaNumberResult {\n  raw: number | string;\n  value: string;\n  unit: string;\n  unitI18n: string;\n}\n\n/**\n * Large number format filter\n *\n * 大数据格式化\n * ```ts\n * 1000 => { value: '1', unit: 'K', unitI18n: '千' }\n * 12456 => { value: '12.46', unit: 'K', unitI18n: '千' }\n * ```\n */\nexport function megaNumber(\n  value: number | string,\n  precision: number = 2,\n  unitI18n: MegaNumberUnitI18n = { Q: '京', T: '兆', B: '亿', M: '万', K: '千' },\n): MegaNumberResult {\n  const num = parseFloat(value.toString());\n  const res: MegaNumberResult = { raw: value, value: '', unit: '', unitI18n: '' };\n  if (isNaN(num) || num === 0) {\n    res.value = value.toString();\n    return res;\n  }\n  let abs = Math.abs(+value);\n  const rounder = Math.pow(10, precision!);\n  const isNegative = num < 0;\n  for (const p of MEGA_POWERS) {\n    let reduced = abs / p.value;\n\n    reduced = Math.round(reduced * rounder) / rounder;\n\n    if (reduced >= 1) {\n      abs = reduced;\n      res.unit = p.unit;\n      break;\n    }\n  }\n\n  res.value = (isNegative ? '-' : '') + abs;\n  res.unitI18n = (unitI18n as { [key: string]: any })[res.unit];\n  return res;\n}\n"],"names":[],"mappings":"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"}