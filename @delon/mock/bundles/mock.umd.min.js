/**
 * @license ng-alain(cipchk@qq.com) v9.0.0-rc.3
 * (c) 2020 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common/http"),require("@delon/util"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@delon/mock",["exports","@angular/core","@angular/common/http","@delon/util","rxjs","rxjs/operators"],t):t(((e=e||self).delon=e.delon||{},e.delon.mock={}),e.ng.core,e.ng.common.http,e.util,e.rxjs,e.rxjs.operators)}(this,(function(e,t,r,o,n,c){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var i=function(){return(i=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};var a=function(e,t){this.status=e,this.error=t};var u=function(){this.delay=300,this.force=!1,this.log=!0,this.copy=!0,this.executeOtherInterceptors=!0};var s=function(){function e(e){this.config=e,this.cached=[],this.applyMock(),delete this.config.data}return e.prototype.applyMock=function(){this.cached=[];try{this.realApplyMock()}catch(e){this.outputError(e)}},e.prototype.realApplyMock=function(){var e=this,t=this.config.data;t&&(Object.keys(t).forEach((function(r){var o=t[r];o&&Object.keys(o).forEach((function(t){var n=o[t];if("function"!=typeof n&&"object"!=typeof n&&"string"!=typeof n)throw Error("mock value of ["+r+"-"+t+"] should be function or object or string, but got "+typeof n);var c=e.genRule(t,n);if(-1===["GET","POST","PUT","HEAD","DELETE","PATCH","OPTIONS"].indexOf(c.method))throw Error("method of "+r+"-"+t+" is not valid");var i=e.cached.find((function(e){return e.url===c.url&&e.method===c.method}));i?i.callback=c.callback:e.cached.push(c)}))})),this.cached.sort((function(e,t){return(t.martcher||"").toString().length-(e.martcher||"").toString().length})))},e.prototype.genRule=function(e,t){var r="GET",o=e;if(e.indexOf(" ")>-1){var n=e.split(" ");r=n[0].toLowerCase(),o=n[1]}var c=null,i=[];if(~o.indexOf(":")){i=o.split("/").filter((function(e){return e.startsWith(":")})).map((function(e){return e.substring(1)}));var a=o.split("/").map((function(e){return e.startsWith(":")?"([^/]+)":e})).join("/");c=new RegExp("^"+a,"i")}else/(\([^)]+\))/i.test(o)&&(c=new RegExp(o,"i"));return{url:o,martcher:c,segments:i,callback:t,method:r.toUpperCase()}},e.prototype.outputError=function(e){var t=e.message.split(": ")[0],r=e.stack.split("\n").filter((function(e){return 0!==e.trim().indexOf("at ")})).map((function(e){return e.replace(t+": ","")}));throw r.splice(1,0,""),console.group(),console.warn("==========Failed to parse mock config.=========="),console.log(r.join("\n")),console.groupEnd(),e},e.prototype.getRule=function(e,t){e=(e||"GET").toUpperCase();var r={},o=this.cached.filter((function(r){return r.method===e&&(r.martcher?r.martcher.test(t):r.url===t)}));if(0===o.length)return null;var n=o.find((function(e){return e.url===t}))||o[0];n.martcher&&n.martcher.exec(t).slice(1).map((function(e,t){r[n.segments[t]]=e}));return{url:t,method:n.method,params:r,callback:n.callback}},e.prototype.clearCache=function(){this.cached=[]},Object.defineProperty(e.prototype,"rules",{get:function(){return this.cached},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.clearCache()},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:u}]},e}();var l=function(){function e(e,t){this.next=e,this.interceptor=t}return e.prototype.handle=function(e){return this.interceptor.intercept(e,this.next)},e}();var p=function(){function e(e){this.injector=e}return e.prototype.intercept=function(e,t){var p,f=this.injector.get(s),h=i({delay:300,force:!1,log:!0,executeOtherInterceptors:!0},this.injector.get(u)),d=f.getRule(e.method,e.url.split("?")[0]);if(!d&&!h.force)return t.handle(e);switch(typeof d.callback){case"function":var g={original:e,body:e.body,queryString:{},headers:{},params:d.params},y=e.url.split("?");y.length>1&&y[1].split("&").forEach((function(e){var t=e.split("="),r=t[0],o=t[1];Object.keys(g.queryString).includes(r)?(Array.isArray(g.queryString[r])||(g.queryString[r]=[g.queryString[r]]),g.queryString[r].push(o)):g.queryString[r]=o})),e.params.keys().forEach((function(t){return g.queryString[t]=e.params.get(t)})),e.headers.keys().forEach((function(t){return g.headers[t]=e.headers.get(t)}));try{p=d.callback.call(this,g)}catch(t){p=new r.HttpErrorResponse({url:e.url,headers:e.headers,status:t instanceof a?t.status:400,statusText:t.statusText||"Unknown Error",error:t.error})}break;default:p=d.callback}p instanceof r.HttpResponseBase||(p=new r.HttpResponse({status:200,url:e.url,body:p})),h.copy&&p.body&&(p.body=o.deepCopy(p.body)),h.log&&(console.log("%cðŸ‘½"+e.method+"->"+e.url+"->request","background:#000;color:#bada55",e),console.log("%cðŸ‘½"+e.method+"->"+e.url+"->response","background:#000;color:#bada55",p));var m=p instanceof r.HttpErrorResponse?n.throwError(p):n.of(p);if(h.executeOtherInterceptors){var b=this.injector.get(r.HTTP_INTERCEPTORS,[]),v=b.slice(b.indexOf(this)+1);if(v.length>0)return v.reduceRight((function(e,t){return new l(e,t)}),{handle:function(){return m}}).handle(e).pipe(c.delay(h.delay))}return m.pipe(c.delay(h.delay))},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:t.Injector}]},e}();var f=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[s,{provide:u,useValue:t},{provide:r.HTTP_INTERCEPTORS,useClass:p,multi:!0}]}},e.forChild=function(){return{ngModule:e,providers:[{provide:r.HTTP_INTERCEPTORS,useClass:p,multi:!0}]}},e.decorators=[{type:t.NgModule,args:[{}]}],e}();e.DelonMockConfig=u,e.DelonMockModule=f,e.MockInterceptor=p,e.MockService=s,e.MockStatusError=a,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=mock.umd.min.js.map