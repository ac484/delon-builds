/**
 * @license ng-alain(cipchk@qq.com) v7.2.0
 * (c) 2019 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@delon/mock",["exports","@angular/core","@angular/common/http","rxjs","rxjs/operators"],e):e(((t=t||self).delon=t.delon||{},t.delon.mock={}),t.ng.core,t.ng.common.http,t.rxjs,t.rxjs.operators)}(this,function(t,e,r,n,o){"use strict";var c=function(){return(c=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=function(){return function(t,e){this.status=t,this.error=e}}(),a=function(){return function(){this.delay=300,this.force=!1,this.log=!0,this.executeOtherInterceptors=!0}}(),u=function(){function t(t){this.config=t,this.cached=[],this.applyMock(),delete this.config.data}return t.prototype.applyMock=function(){this.cached=[];try{this.realApplyMock()}catch(t){this.outputError(t)}},t.prototype.realApplyMock=function(){var t=this,e=this.config.data;e&&(Object.keys(e).forEach(function(r){var n=e[r];n&&Object.keys(n).forEach(function(e){var o=n[e];if("function"!=typeof o&&"object"!=typeof o&&"string"!=typeof o)throw Error("mock value of ["+r+"-"+e+"] should be function or object or string, but got "+typeof o);var c=t.genRule(e,o);if(-1===["GET","POST","PUT","HEAD","DELETE","PATCH","OPTIONS"].indexOf(c.method))throw Error("method of "+r+"-"+e+" is not valid");var i=t.cached.find(function(t){return t.url===c.url&&t.method===c.method});i?i.callback=c.callback:t.cached.push(c)})}),this.cached.sort(function(t,e){return(e.martcher||"").toString().length-(t.martcher||"").toString().length}))},t.prototype.genRule=function(t,e){var r="GET",n=t;if(t.indexOf(" ")>-1){var o=t.split(" ");r=o[0].toLowerCase(),n=o[1]}var c=null,i=[];if(~n.indexOf(":")){i=n.split("/").filter(function(t){return t.startsWith(":")}).map(function(t){return t.substring(1)});var a=n.split("/").map(function(t){return t.startsWith(":")?"([^/]+)":t}).join("/");c=new RegExp("^"+a,"i")}else/(\([^)]+\))/i.test(n)&&(c=new RegExp(n,"i"));return{url:n,martcher:c,segments:i,callback:e,method:r.toUpperCase()}},t.prototype.outputError=function(t){var e=t.message.split(": ")[0],r=t.stack.split("\n").filter(function(t){return 0!==t.trim().indexOf("at ")}).map(function(t){return t.replace(e+": ","")});throw r.splice(1,0,[""]),console.group(),console.warn("==========Failed to parse mock config.=========="),console.log(r.join("\n")),console.groupEnd(),t},t.prototype.getRule=function(t,e){t=(t||"GET").toUpperCase();var r={},n=this.cached.filter(function(r){return r.method===t&&(r.martcher?r.martcher.test(e):r.url===e)});if(0===n.length)return null;var o=n.find(function(t){return t.url===e})||n[0];o.martcher&&o.martcher.exec(e).slice(1).map(function(t,e){r[o.segments[e]]=t});return{url:e,method:o.method,params:r,callback:o.callback}},t.prototype.clearCache=function(){this.cached=[]},Object.defineProperty(t.prototype,"rules",{get:function(){return this.cached},enumerable:!0,configurable:!0}),t.prototype.ngOnDestroy=function(){this.clearCache()},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:a}]},t}(),s=function(){function t(t,e){this.next=t,this.interceptor=e}return t.prototype.handle=function(t){return this.interceptor.intercept(t,this.next)},t}(),l=function(){function t(t){this.injector=t}return t.prototype.intercept=function(t,e){var l,p=this.injector.get(u),f=c({delay:300,force:!1,log:!0,executeOtherInterceptors:!0},this.injector.get(a,null)),h=p.getRule(t.method,t.url.split("?")[0]);if(!h&&!f.force)return e.handle(t);switch(typeof h.callback){case"function":var d={original:t,body:t.body,queryString:{},headers:{},params:h.params},g=t.url.split("?");g.length>1&&g[1].split("&").forEach(function(t){var e=t.split("="),r=e[0],n=e[1];Object.keys(d.queryString).includes(r)?(Array.isArray(d.queryString[r])||(d.queryString[r]=[d.queryString[r]]),d.queryString[r].push(n)):d.queryString[r]=n}),t.params.keys().forEach(function(e){return d.queryString[e]=t.params.get(e)}),t.headers.keys().forEach(function(e){return d.headers[e]=t.headers.get(e)});try{l=h.callback.call(this,d)}catch(k){l=new r.HttpErrorResponse({url:t.url,headers:t.headers,status:400,statusText:k.statusText||"Unknown Error",error:k.error}),k instanceof i&&(l.status=k.status)}break;default:l=h.callback}l instanceof r.HttpResponseBase||(l=new r.HttpResponse({status:200,url:t.url,body:l})),f.log&&(console.log("%cðŸ‘½"+t.method+"->"+t.url+"->request","background:#000;color:#bada55",t),console.log("%cðŸ‘½"+t.method+"->"+t.url+"->response","background:#000;color:#bada55",l));var y=l instanceof r.HttpErrorResponse?n.throwError(l):n.of(l);if(f.executeOtherInterceptors){var m=this.injector.get(r.HTTP_INTERCEPTORS,[]),b=m.slice(m.indexOf(this)+1);if(b.length>0)return b.reduceRight(function(t,e){return new s(t,e)},{handle:function(){return y}}).handle(t).pipe(o.delay(f.delay))}return y.pipe(o.delay(f.delay))},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:e.Injector}]},t}(),p=function(){function t(){}return t.forRoot=function(e){return{ngModule:t,providers:[u,{provide:a,useValue:e},{provide:r.HTTP_INTERCEPTORS,useClass:l,multi:!0}]}},t.forChild=function(){return{ngModule:t,providers:[{provide:r.HTTP_INTERCEPTORS,useClass:l,multi:!0}]}},t.decorators=[{type:e.NgModule,args:[{}]}],t}();t.DelonMockConfig=a,t.DelonMockModule=p,t.MockInterceptor=l,t.MockService=u,t.MockStatusError=i,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=mock.umd.min.js.map