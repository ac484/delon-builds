{"version":3,"file":"pageHeader.js.map","sources":["ng://@delon/abc/page-header/page-header.config.ts","ng://@delon/abc/page-header/page-header.component.ts","ng://@delon/abc/page-header/page-header.module.ts"],"sourcesContent":["export class PageHeaderConfig {\r\n  /**\r\n   * é¦é¡µææ¬ï¼è¥æå®ç©ºè¡¨ç¤ºä¸æ¾ç¤º\r\n   */\r\n  home?: string = 'é¦é¡µ';\r\n  /**\r\n   * é¦é¡µé¾æ¥\r\n   */\r\n  homeLink?: string = '/';\r\n  /**\r\n   * é¦é¡µé¾æ¥å½éååæ°\r\n   */\r\n  homeI18n?: string;\r\n  /**\r\n   * èªå¨çæå¯¼èªï¼ä»¥å½åè·¯ç±ä»ä¸»èåä¸­å®ä½\r\n   */\r\n  autoBreadcrumb?: boolean = true;\r\n  /**\r\n   * èªå¨çææ é¢ï¼ä»¥å½åè·¯ç±ä»ä¸»èåä¸­å®ä½\r\n   */\r\n  autoTitle?: boolean = true;\r\n  /**\r\n   * æ¯å¦èªå¨å°æ åä¿¡æ¯åæ­¥è³ `TitleService`ã`ReuseService` ä¸\r\n   */\r\n  syncTitle?: boolean = false;\r\n  /**\r\n   * æ¯å¦åºå®æ¨¡å¼\r\n   */\r\n  fixed? = false;\r\n  /**\r\n   * åºå®åç§»å¼\r\n   */\r\n  fixedOffsetTop? = 64;\r\n}\r\n","import {\r\n  Component,\r\n  Input,\r\n  TemplateRef,\r\n  ContentChild,\r\n  OnInit,\r\n  OnChanges,\r\n  Inject,\r\n  Optional,\r\n  ViewChild,\r\n  ElementRef,\r\n  AfterViewInit,\r\n  Renderer2,\r\n  OnDestroy,\r\n} from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { NzAffixComponent } from 'ng-zorro-antd';\r\nimport { Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\n\r\nimport { isEmpty, InputBoolean, InputNumber } from '@delon/util';\r\nimport {\r\n  MenuService,\r\n  ALAIN_I18N_TOKEN,\r\n  AlainI18NService,\r\n  Menu,\r\n  TitleService,\r\n  SettingsService,\r\n} from '@delon/theme';\r\nimport { ReuseTabService } from '@delon/abc/reuse-tab';\r\n\r\nimport { PageHeaderConfig } from './page-header.config';\r\n\r\n@Component({\r\n  selector: 'page-header',\r\n  templateUrl: './page-header.component.html',\r\n  preserveWhitespaces: false,\r\n})\r\nexport class PageHeaderComponent\r\n  implements OnInit, OnChanges, AfterViewInit, OnDestroy {\r\n  private inited = false;\r\n  private i18n$: Subscription;\r\n  private set$: Subscription;\r\n  @ViewChild('conTpl')\r\n  private conTpl: ElementRef;\r\n  @ViewChild('affix')\r\n  private affix: NzAffixComponent;\r\n  private _menus: Menu[];\r\n\r\n  private get menus() {\r\n    if (this._menus) {\r\n      return this._menus;\r\n    }\r\n    this._menus = this.menuSrv.getPathByUrl(this.route.url.split('?')[0]);\r\n\r\n    return this._menus;\r\n  }\r\n\r\n  // region fields\r\n\r\n  _title: string;\r\n  _titleTpl: TemplateRef<any>;\r\n  @Input()\r\n  set title(value: string | TemplateRef<any>) {\r\n    if (value instanceof TemplateRef) {\r\n      this._title = null;\r\n      this._titleTpl = value;\r\n    } else {\r\n      this._title = value;\r\n    }\r\n  }\r\n\r\n  @Input()\r\n  home: string;\r\n\r\n  @Input()\r\n  homeLink: string;\r\n\r\n  @Input()\r\n  homeI18n: string;\r\n\r\n  /**\r\n   * èªå¨çæå¯¼èªï¼ä»¥å½åè·¯ç±ä»ä¸»èåä¸­å®ä½\r\n   */\r\n  @Input()\r\n  @InputBoolean()\r\n  autoBreadcrumb: boolean;\r\n\r\n  /**\r\n   * èªå¨çææ é¢ï¼ä»¥å½åè·¯ç±ä»ä¸»èåä¸­å®ä½\r\n   */\r\n  @Input()\r\n  @InputBoolean()\r\n  autoTitle: boolean;\r\n\r\n  /**\r\n   * æ¯å¦èªå¨å°æ é¢åæ­¥è³ `TitleService`ã`ReuseService` ä¸ï¼ä» `title` ä¸º `string` ç±»åæ¶ææ\r\n   */\r\n  @Input()\r\n  @InputBoolean()\r\n  syncTitle: boolean;\r\n\r\n  @Input()\r\n  @InputBoolean()\r\n  fixed: boolean;\r\n\r\n  @Input()\r\n  @InputNumber()\r\n  fixedOffsetTop: number;\r\n\r\n  paths: any[] = [];\r\n\r\n  @Input()\r\n  breadcrumb: TemplateRef<any>;\r\n\r\n  @Input()\r\n  logo: TemplateRef<any>;\r\n\r\n  @Input()\r\n  action: TemplateRef<any>;\r\n\r\n  @Input()\r\n  content: TemplateRef<any>;\r\n\r\n  @Input()\r\n  extra: TemplateRef<any>;\r\n\r\n  @Input()\r\n  tab: TemplateRef<any>;\r\n\r\n  // endregion\r\n\r\n  constructor(\r\n    cog: PageHeaderConfig,\r\n    settings: SettingsService,\r\n    private renderer: Renderer2,\r\n    private route: Router,\r\n    private menuSrv: MenuService,\r\n    @Optional()\r\n    @Inject(ALAIN_I18N_TOKEN)\r\n    private i18nSrv: AlainI18NService,\r\n    @Optional()\r\n    @Inject(TitleService)\r\n    private titleSrv: TitleService,\r\n    @Optional()\r\n    @Inject(ReuseTabService)\r\n    private reuseSrv: ReuseTabService,\r\n  ) {\r\n    Object.assign(this, cog);\r\n    if (this.i18nSrv) {\r\n      this.i18n$ = this.i18nSrv.change.subscribe(() => this.refresh());\r\n    }\r\n    this.set$ = settings.notify\r\n      .pipe(\r\n        filter(\r\n          w => this.affix && w.type === 'layout' && w.name === 'collapsed',\r\n        ),\r\n      )\r\n      .subscribe(() => this.affix.updatePosition({}));\r\n  }\r\n\r\n  refresh() {\r\n    this.setTitle().genBreadcrumb();\r\n  }\r\n\r\n  private genBreadcrumb() {\r\n    if (this.breadcrumb || !this.autoBreadcrumb || this.menus.length <= 0)\r\n      return;\r\n    const paths: any[] = [];\r\n    this.menus.forEach(item => {\r\n      if (typeof item.hideInBreadcrumb !== 'undefined' && item.hideInBreadcrumb)\r\n        return;\r\n      let title = item.text;\r\n      if (item.i18n && this.i18nSrv) title = this.i18nSrv.fanyi(item.i18n);\r\n      paths.push({ title, link: item.link && [item.link] });\r\n    });\r\n    // add home\r\n    if (this.home) {\r\n      paths.splice(0, 0, {\r\n        title:\r\n          (this.homeI18n &&\r\n            this.i18nSrv &&\r\n            this.i18nSrv.fanyi(this.homeI18n)) ||\r\n          this.home,\r\n        link: [this.homeLink],\r\n      });\r\n    }\r\n    this.paths = paths;\r\n    return this;\r\n  }\r\n\r\n  private setTitle() {\r\n    if (\r\n      typeof this._title === 'undefined' &&\r\n      typeof this._titleTpl === 'undefined' &&\r\n      this.autoTitle &&\r\n      this.menus.length > 0\r\n    ) {\r\n      const item = this.menus[this.menus.length - 1];\r\n      let title = item.text;\r\n      if (item.i18n && this.i18nSrv) title = this.i18nSrv.fanyi(item.i18n);\r\n      this._title = title;\r\n    }\r\n\r\n    if (this._title && this.syncTitle) {\r\n      if (this.titleSrv) {\r\n        this.titleSrv.setTitle(this._title);\r\n      }\r\n      if (this.reuseSrv) {\r\n        this.reuseSrv.title = this._title;\r\n      }\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  checkContent() {\r\n    if (isEmpty(this.conTpl.nativeElement)) {\r\n      this.renderer.setAttribute(this.conTpl.nativeElement, 'hidden', '');\r\n    } else {\r\n      this.renderer.removeAttribute(this.conTpl.nativeElement, 'hidden');\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.refresh();\r\n    this.inited = true;\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.checkContent();\r\n  }\r\n\r\n  ngOnChanges(): void {\r\n    if (this.inited) this.refresh();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.i18n$) this.i18n$.unsubscribe();\r\n    this.set$.unsubscribe();\r\n  }\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { RouterModule } from '@angular/router';\r\nimport { NgZorroAntdModule } from 'ng-zorro-antd';\r\nimport { DelonUtilModule } from '@delon/util';\r\n\r\nimport { PageHeaderComponent } from './page-header.component';\r\nimport { PageHeaderConfig } from './page-header.config';\r\n\r\nconst COMPONENTS = [PageHeaderComponent];\r\n\r\n@NgModule({\r\n  imports: [CommonModule, RouterModule, DelonUtilModule, NgZorroAntdModule],\r\n  declarations: [...COMPONENTS],\r\n  exports: [...COMPONENTS],\r\n})\r\nexport class PageHeaderModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return { ngModule: PageHeaderModule, providers: [PageHeaderConfig] };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAAA;;;;;oBAIkB,IAAI;;;;wBAIA,GAAG;;;;8BAQI,IAAI;;;;yBAIT,IAAI;;;;yBAIJ,KAAK;;;;qBAIlB,KAAK;;;;8BAII,EAAE;;CACrB;;;;;;;;;;;;;;;;;ICmGC,YACE,GAAqB,EACrB,QAAyB,EACjB,UACA,OACA,SAGA,OAAyB,EAGzB,QAAsB,EAGtB,QAAyB;QAXzB,aAAQ,GAAR,QAAQ;QACR,UAAK,GAAL,KAAK;QACL,YAAO,GAAP,OAAO;QAGP,YAAO,GAAP,OAAO,CAAkB;QAGzB,aAAQ,GAAR,QAAQ,CAAc;QAGtB,aAAQ,GAAR,QAAQ,CAAiB;sBA1GlB,KAAK;qBAsEP,EAAE;QAsCf,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;QACzB,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC;SAClE;QACD,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,MAAM;aACxB,IAAI,CACH,MAAM,CACJ,CAAC,IAAI,IAAI,CAAC,KAAK,IAAI,CAAC,CAAC,IAAI,KAAK,QAAQ,IAAI,CAAC,CAAC,IAAI,KAAK,WAAW,CACjE,CACF;aACA,SAAS,CAAC,MAAM,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC,CAAC;KACnD;;;;QA9GW,KAAK;QACf,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,OAAO,IAAI,CAAC,MAAM,CAAC;SACpB;QACD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAEtE,OAAO,IAAI,CAAC,MAAM,CAAC;;;;;;IAOrB,IACI,KAAK,CAAC,KAAgC;QACxC,IAAI,KAAK,YAAY,WAAW,EAAE;YAChC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;SACxB;aAAM;YACL,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;SACrB;KACF;;;;IA2FD,OAAO;QACL,IAAI,CAAC,QAAQ,EAAE,CAAC,aAAa,EAAE,CAAC;KACjC;;;;IAEO,aAAa;QACnB,IAAI,IAAI,CAAC,UAAU,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC;YACnE,OAAO;;QACT,MAAM,KAAK,GAAU,EAAE,CAAC;QACxB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI;YACrB,IAAI,OAAO,IAAI,CAAC,gBAAgB,KAAK,WAAW,IAAI,IAAI,CAAC,gBAAgB;gBACvE,OAAO;;YACT,IAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC;YACtB,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO;gBAAE,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrE,KAAK,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACvD,CAAC,CAAC;;QAEH,IAAI,IAAI,CAAC,IAAI,EAAE;YACb,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE;gBACjB,KAAK,EACH,CAAC,IAAI,CAAC,QAAQ;oBACZ,IAAI,CAAC,OAAO;oBACZ,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC;oBACnC,IAAI,CAAC,IAAI;gBACX,IAAI,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC;aACtB,CAAC,CAAC;SACJ;QACD,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,OAAO,IAAI,CAAC;;;;;IAGN,QAAQ;QACd,IACE,OAAO,IAAI,CAAC,MAAM,KAAK,WAAW;YAClC,OAAO,IAAI,CAAC,SAAS,KAAK,WAAW;YACrC,IAAI,CAAC,SAAS;YACd,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EACrB;;YACA,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;;YAC/C,IAAI,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC;YACtB,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO;gBAAE,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrE,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;SACrB;QAED,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,SAAS,EAAE;YACjC,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aACrC;YACD,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;aACnC;SACF;QAED,OAAO,IAAI,CAAC;;;;;IAGd,YAAY;QACV,IAAI,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,EAAE;YACtC,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAC;SACrE;aAAM;YACL,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;SACpE;KACF;;;;IAED,QAAQ;QACN,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;KACpB;;;;IAED,eAAe;QACb,IAAI,CAAC,YAAY,EAAE,CAAC;KACrB;;;;IAED,WAAW;QACT,IAAI,IAAI,CAAC,MAAM;YAAE,IAAI,CAAC,OAAO,EAAE,CAAC;KACjC;;;;IAED,WAAW;QACT,IAAI,IAAI,CAAC,KAAK;YAAE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;QACzC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;KACzB;;;YA/MF,SAAS,SAAC;gBACT,QAAQ,EAAE,aAAa;gBACvB,s2DAA2C;gBAC3C,mBAAmB,EAAE,KAAK;aAC3B;;;;YANQ,gBAAgB;YAJvB,eAAe;YAff,SAAS;YAGF,MAAM;YAOb,WAAW;4CAoHR,QAAQ,YACR,MAAM,SAAC,gBAAgB;YAjH1B,YAAY,uBAmHT,QAAQ,YACR,MAAM,SAAC,YAAY;YAjHf,eAAe,uBAmHnB,QAAQ,YACR,MAAM,SAAC,eAAe;;;qBAtGxB,SAAS,SAAC,QAAQ;oBAElB,SAAS,SAAC,OAAO;oBAiBjB,KAAK;mBAUL,KAAK;uBAGL,KAAK;uBAGL,KAAK;6BAML,KAAK;wBAOL,KAAK;wBAOL,KAAK;oBAIL,KAAK;6BAIL,KAAK;yBAML,KAAK;mBAGL,KAAK;qBAGL,KAAK;sBAGL,KAAK;oBAGL,KAAK;kBAGL,KAAK;;;IA1CL,YAAY,EAAE;;;;IAOd,YAAY,EAAE;;;;IAOd,YAAY,EAAE;;;;IAId,YAAY,EAAE;;;;IAId,WAAW,EAAE;;;;;;;;AC3GhB;AASA,MAAM,UAAU,GAAG,CAAC,mBAAmB,CAAC,CAAC;AAOzC;;;;IACE,OAAO,OAAO;QACZ,OAAO,EAAE,QAAQ,EAAE,gBAAgB,EAAE,SAAS,EAAE,CAAC,gBAAgB,CAAC,EAAE,CAAC;KACtE;;;YARF,QAAQ,SAAC;gBACR,OAAO,EAAE,CAAC,YAAY,EAAE,YAAY,EAAE,eAAe,EAAE,iBAAiB,CAAC;gBACzE,YAAY,EAAE,CAAC,GAAG,UAAU,CAAC;gBAC7B,OAAO,EAAE,CAAC,GAAG,UAAU,CAAC;aACzB;;;;;;;;;;;;;;;"}
