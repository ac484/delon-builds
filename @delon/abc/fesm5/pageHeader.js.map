{"version":3,"file":"pageHeader.js.map","sources":["ng://@delon/abc/page-header/page-header.config.ts","ng://@delon/abc/page-header/page-header.component.ts","ng://@delon/abc/page-header/page-header.module.ts"],"sourcesContent":["export class PageHeaderConfig {\n  /**\n   * é¦é¡µææ¬ï¼è¥æå®ç©ºè¡¨ç¤ºä¸æ¾ç¤º\n   */\n  home?: string = 'é¦é¡µ';\n  /**\n   * é¦é¡µé¾æ¥\n   */\n  homeLink?: string = '/';\n  /**\n   * é¦é¡µé¾æ¥å½éååæ°\n   */\n  homeI18n?: string;\n  /**\n   * èªå¨çæå¯¼èªï¼ä»¥å½åè·¯ç±ä»ä¸»èåä¸­å®ä½\n   */\n  autoBreadcrumb?: boolean = true;\n  /**\n   * èªå¨åä¸éå½æ¥æ¾\n   *  - èåæ°æ®æºåå« `/ware`ï¼å `/ware/1` ä¹è§ä¸º `/ware` é¡¹\n   */\n  recursiveBreadcrumb?: boolean = false;\n  /**\n   * èªå¨çææ é¢ï¼ä»¥å½åè·¯ç±ä»ä¸»èåä¸­å®ä½\n   */\n  autoTitle?: boolean = true;\n  /**\n   * æ¯å¦èªå¨å°æ åä¿¡æ¯åæ­¥è³ `TitleService`ã`ReuseService` ä¸\n   */\n  syncTitle?: boolean = false;\n  /**\n   * æ¯å¦åºå®æ¨¡å¼\n   */\n  fixed? = false;\n  /**\n   * åºå®åç§»å¼\n   */\n  fixedOffsetTop? = 64;\n}\n","import {\n  Component,\n  Input,\n  TemplateRef,\n  OnInit,\n  OnChanges,\n  Inject,\n  Optional,\n  ViewChild,\n  ElementRef,\n  AfterViewInit,\n  Renderer2,\n  OnDestroy,\n} from '@angular/core';\nimport { Router, RouterEvent, NavigationEnd } from '@angular/router';\nimport { NzAffixComponent } from 'ng-zorro-antd';\nimport { Subscription, Observable, merge } from 'rxjs';\nimport { filter } from 'rxjs/operators';\n\nimport { isEmpty, InputBoolean, InputNumber } from '@delon/util';\nimport {\n  MenuService,\n  ALAIN_I18N_TOKEN,\n  AlainI18NService,\n  Menu,\n  TitleService,\n  SettingsService,\n} from '@delon/theme';\nimport { ReuseTabService } from '@delon/abc/reuse-tab';\n\nimport { PageHeaderConfig } from './page-header.config';\n\n@Component({\n  selector: 'page-header',\n  templateUrl: './page-header.component.html',\n})\nexport class PageHeaderComponent\n  implements OnInit, OnChanges, AfterViewInit, OnDestroy {\n  private inited = false;\n  private ref$: Subscription;\n  private set$: Subscription;\n  @ViewChild('conTpl')\n  private conTpl: ElementRef;\n  @ViewChild('affix')\n  private affix: NzAffixComponent;\n  private _menus: Menu[];\n\n  private get menus() {\n    if (this._menus) {\n      return this._menus;\n    }\n    this._menus = this.menuSrv.getPathByUrl(\n      this.router.url.split('?')[0],\n      this.recursiveBreadcrumb,\n    );\n\n    return this._menus;\n  }\n\n  _titleVal: string;\n\n  // #region fields\n\n  _title: string;\n  _titleTpl: TemplateRef<any>;\n  @Input()\n  set title(value: string | TemplateRef<any>) {\n    if (value instanceof TemplateRef) {\n      this._title = null;\n      this._titleTpl = value;\n    } else {\n      this._title = value;\n    }\n    this._titleVal = this._title;\n  }\n\n  @Input()\n  @InputBoolean()\n  loading = false;\n\n  @Input()\n  @InputBoolean()\n  wide = false;\n\n  @Input()\n  home: string;\n\n  @Input()\n  homeLink: string;\n\n  @Input()\n  homeI18n: string;\n\n  /**\n   * èªå¨çæå¯¼èªï¼ä»¥å½åè·¯ç±ä»ä¸»èåä¸­å®ä½\n   */\n  @Input()\n  @InputBoolean()\n  autoBreadcrumb: boolean;\n\n  /**\n   * èªå¨çææ é¢ï¼ä»¥å½åè·¯ç±ä»ä¸»èåä¸­å®ä½\n   */\n  @Input()\n  @InputBoolean()\n  autoTitle: boolean;\n\n  /**\n   * æ¯å¦èªå¨å°æ é¢åæ­¥è³ `TitleService`ã`ReuseService` ä¸ï¼ä» `title` ä¸º `string` ç±»åæ¶ææ\n   */\n  @Input()\n  @InputBoolean()\n  syncTitle: boolean;\n\n  @Input()\n  @InputBoolean()\n  fixed: boolean;\n\n  @Input()\n  @InputNumber()\n  fixedOffsetTop: number;\n\n  paths: any[] = [];\n\n  @Input()\n  breadcrumb: TemplateRef<any>;\n\n  @Input()\n  @InputBoolean()\n  recursiveBreadcrumb: boolean;\n\n  @Input()\n  logo: TemplateRef<any>;\n\n  @Input()\n  action: TemplateRef<any>;\n\n  @Input()\n  content: TemplateRef<any>;\n\n  @Input()\n  extra: TemplateRef<any>;\n\n  @Input()\n  tab: TemplateRef<any>;\n\n  // #endregion\n\n  constructor(\n    cog: PageHeaderConfig,\n    settings: SettingsService,\n    private renderer: Renderer2,\n    private router: Router,\n    private menuSrv: MenuService,\n    @Optional()\n    @Inject(ALAIN_I18N_TOKEN)\n    private i18nSrv: AlainI18NService,\n    @Optional()\n    @Inject(TitleService)\n    private titleSrv: TitleService,\n    @Optional()\n    @Inject(ReuseTabService)\n    private reuseSrv: ReuseTabService,\n  ) {\n    Object.assign(this, cog);\n    this.set$ = settings.notify\n      .pipe(\n        filter(\n          w => this.affix && w.type === 'layout' && w.name === 'collapsed',\n        ),\n      )\n      .subscribe(() => this.affix.updatePosition({}));\n\n    const data$: Observable<any>[] = [\n      this.router.events.pipe(\n        filter((event: RouterEvent) => event instanceof NavigationEnd),\n      ),\n    ];\n    if (this.i18nSrv) {\n      data$.push(this.i18nSrv.change);\n    }\n    this.ref$ = merge(...data$).subscribe(() => {\n      this._menus = null;\n      this.refresh();\n    });\n  }\n\n  refresh() {\n    this.setTitle().genBreadcrumb();\n  }\n\n  private genBreadcrumb() {\n    if (this.breadcrumb || !this.autoBreadcrumb || this.menus.length <= 0) {\n      this.paths = [];\n      return;\n    }\n    const paths: any[] = [];\n    this.menus.forEach(item => {\n      if (typeof item.hideInBreadcrumb !== 'undefined' && item.hideInBreadcrumb)\n        return;\n      let title = item.text;\n      if (item.i18n && this.i18nSrv) title = this.i18nSrv.fanyi(item.i18n);\n      paths.push({ title, link: item.link && [item.link] });\n    });\n    // add home\n    if (this.home) {\n      paths.splice(0, 0, {\n        title:\n          (this.homeI18n &&\n            this.i18nSrv &&\n            this.i18nSrv.fanyi(this.homeI18n)) ||\n          this.home,\n        link: [this.homeLink],\n      });\n    }\n    this.paths = paths;\n    return this;\n  }\n\n  private setTitle() {\n    if (\n      typeof this._title === 'undefined' &&\n      typeof this._titleTpl === 'undefined' &&\n      this.autoTitle &&\n      this.menus.length > 0\n    ) {\n      const item = this.menus[this.menus.length - 1];\n      let title = item.text;\n      if (item.i18n && this.i18nSrv) title = this.i18nSrv.fanyi(item.i18n);\n      this._titleVal = title;\n    }\n\n    if (this._titleVal && this.syncTitle) {\n      if (this.titleSrv) {\n        this.titleSrv.setTitle(this._titleVal);\n      }\n      if (this.reuseSrv) {\n        this.reuseSrv.title = this._titleVal;\n      }\n    }\n\n    return this;\n  }\n\n  checkContent() {\n    if (isEmpty(this.conTpl.nativeElement)) {\n      this.renderer.setAttribute(this.conTpl.nativeElement, 'hidden', '');\n    } else {\n      this.renderer.removeAttribute(this.conTpl.nativeElement, 'hidden');\n    }\n  }\n\n  ngOnInit() {\n    this.refresh();\n    this.inited = true;\n  }\n\n  ngAfterViewInit(): void {\n    this.checkContent();\n  }\n\n  ngOnChanges(): void {\n    if (this.inited) this.refresh();\n  }\n\n  ngOnDestroy(): void {\n    this.set$.unsubscribe();\n    this.ref$.unsubscribe();\n  }\n}\n","import { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { NgZorroAntdModule } from 'ng-zorro-antd';\nimport { DelonUtilModule } from '@delon/util';\n\nimport { PageHeaderComponent } from './page-header.component';\nimport { PageHeaderConfig } from './page-header.config';\n\nconst COMPONENTS = [PageHeaderComponent];\n\n@NgModule({\n  imports: [CommonModule, RouterModule, DelonUtilModule, NgZorroAntdModule],\n  declarations: [...COMPONENTS],\n  exports: [...COMPONENTS],\n})\nexport class PageHeaderModule {\n  static forRoot(): ModuleWithProviders {\n    return { ngModule: PageHeaderModule, providers: [PageHeaderConfig] };\n  }\n}\n"],"names":["tslib_1.__decorate"],"mappings":";;;;;;;;;;;;;;;AAAA;IAAA;;;;QAIE,SAAI,GAAY,IAAI,CAAC;;;;QAIrB,aAAQ,GAAY,GAAG,CAAC;;;;QAQxB,mBAAc,GAAa,IAAI,CAAC;;;;;QAKhC,wBAAmB,GAAa,KAAK,CAAC;;;;QAItC,cAAS,GAAa,IAAI,CAAC;;;;QAI3B,cAAS,GAAa,KAAK,CAAC;;;;QAI5B,UAAK,GAAI,KAAK,CAAC;;;;QAIf,mBAAc,GAAI,EAAE,CAAC;KACtB;IAAD,uBAAC;CAAA;;;;;;;;IC8GC,6BACE,GAAqB,EACrB,QAAyB,EACjB,QAAmB,EACnB,MAAc,EACd,OAAoB,EAGpB,OAAyB,EAGzB,QAAsB,EAGtB,QAAyB;QAdnC,iBAqCC;QAlCS,aAAQ,GAAR,QAAQ,CAAW;QACnB,WAAM,GAAN,MAAM,CAAQ;QACd,YAAO,GAAP,OAAO,CAAa;QAGpB,YAAO,GAAP,OAAO,CAAkB;QAGzB,aAAQ,GAAR,QAAQ,CAAc;QAGtB,aAAQ,GAAR,QAAQ,CAAiB;QA5H3B,WAAM,GAAG,KAAK,CAAC;QAwCvB,YAAO,GAAG,KAAK,CAAC;QAIhB,SAAI,GAAG,KAAK,CAAC;QAwCb,UAAK,GAAU,EAAE,CAAC;QA0ChB,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;QACzB,IAAI,CAAC,IAAI,GAAG,QAAQ,CAAC,MAAM;aACxB,IAAI,CACH,MAAM,CACJ,UAAA,CAAC,IAAI,OAAA,KAAI,CAAC,KAAK,IAAI,CAAC,CAAC,IAAI,KAAK,QAAQ,IAAI,CAAC,CAAC,IAAI,KAAK,WAAW,GAAA,CACjE,CACF;aACA,SAAS,CAAC,cAAM,OAAA,KAAI,CAAC,KAAK,CAAC,cAAc,CAAC,EAAE,CAAC,GAAA,CAAC,CAAC;;YAE5C,KAAK,GAAsB;YAC/B,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CACrB,MAAM,CAAC,UAAC,KAAkB,IAAK,OAAA,KAAK,YAAY,aAAa,GAAA,CAAC,CAC/D;SACF;QACD,IAAI,IAAI,CAAC,OAAO,EAAE;YAChB,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;SACjC;QACD,IAAI,CAAC,IAAI,GAAG,KAAK,wBAAI,KAAK,GAAE,SAAS,CAAC;YACpC,KAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,KAAI,CAAC,OAAO,EAAE,CAAC;SAChB,CAAC,CAAC;KACJ;IA1ID,sBAAY,sCAAK;;;;QAAjB;YACE,IAAI,IAAI,CAAC,MAAM,EAAE;gBACf,OAAO,IAAI,CAAC,MAAM,CAAC;aACpB;YACD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CACrC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAC7B,IAAI,CAAC,mBAAmB,CACzB,CAAC;YAEF,OAAO,IAAI,CAAC,MAAM,CAAC;SACpB;;;OAAA;IAQD,sBACI,sCAAK;;;;;QADT,UACU,KAAgC;YACxC,IAAI,KAAK,YAAY,WAAW,EAAE;gBAChC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACnB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;aACxB;iBAAM;gBACL,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;aACrB;YACD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC;SAC9B;;;OAAA;;;;IAiHD,qCAAO;;;IAAP;QACE,IAAI,CAAC,QAAQ,EAAE,CAAC,aAAa,EAAE,CAAC;KACjC;;;;;;IAEO,2CAAa;;;;;IAArB;QAAA,iBA0BC;QAzBC,IAAI,mBAAA,IAAI,GAAC,UAAU,IAAI,CAAC,mBAAA,IAAI,GAAC,cAAc,IAAI,mBAAA,IAAI,GAAC,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE;YACrE,mBAAA,IAAI,GAAC,KAAK,GAAG,EAAE,CAAC;YAChB,OAAO;SACR;;YACK,KAAK,GAAU,EAAE;QACvB,mBAAA,IAAI,GAAC,KAAK,CAAC,OAAO,CAAC,UAAA,IAAI;YACrB,IAAI,OAAO,IAAI,CAAC,gBAAgB,KAAK,WAAW,IAAI,IAAI,CAAC,gBAAgB;gBACvE,OAAO;;gBACL,KAAK,GAAG,IAAI,CAAC,IAAI;YACrB,IAAI,IAAI,CAAC,IAAI,IAAI,mBAAA,KAAI,GAAC,OAAO;gBAAE,KAAK,GAAG,mBAAA,KAAI,GAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrE,KAAK,CAAC,IAAI,CAAC,EAAE,KAAK,OAAA,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;SACvD,CAAC,CAAC;;QAEH,IAAI,mBAAA,IAAI,GAAC,IAAI,EAAE;YACb,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE;gBACjB,KAAK,EACH,CAAC,mBAAA,IAAI,GAAC,QAAQ;oBACZ,mBAAA,IAAI,GAAC,OAAO;oBACZ,mBAAA,IAAI,GAAC,OAAO,CAAC,KAAK,CAAC,mBAAA,IAAI,GAAC,QAAQ,CAAC;oBACnC,mBAAA,IAAI,GAAC,IAAI;gBACX,IAAI,EAAE,CAAC,mBAAA,IAAI,GAAC,QAAQ,CAAC;aACtB,CAAC,CAAC;SACJ;QACD,mBAAA,IAAI,GAAC,KAAK,GAAG,KAAK,CAAC;QACnB,0BAAO,IAAI,GAAC;KACb;;;;;;IAEO,sCAAQ;;;;;IAAhB;QACE,IACE,OAAO,mBAAA,IAAI,GAAC,MAAM,KAAK,WAAW;YAClC,OAAO,mBAAA,IAAI,GAAC,SAAS,KAAK,WAAW;YACrC,mBAAA,IAAI,GAAC,SAAS;YACd,mBAAA,IAAI,GAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EACrB;;gBACM,IAAI,GAAG,mBAAA,IAAI,GAAC,KAAK,CAAC,mBAAA,IAAI,GAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;;gBAC1C,KAAK,GAAG,IAAI,CAAC,IAAI;YACrB,IAAI,IAAI,CAAC,IAAI,IAAI,mBAAA,IAAI,GAAC,OAAO;gBAAE,KAAK,GAAG,mBAAA,IAAI,GAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrE,mBAAA,IAAI,GAAC,SAAS,GAAG,KAAK,CAAC;SACxB;QAED,IAAI,mBAAA,IAAI,GAAC,SAAS,IAAI,mBAAA,IAAI,GAAC,SAAS,EAAE;YACpC,IAAI,mBAAA,IAAI,GAAC,QAAQ,EAAE;gBACjB,mBAAA,IAAI,GAAC,QAAQ,CAAC,QAAQ,CAAC,mBAAA,IAAI,GAAC,SAAS,CAAC,CAAC;aACxC;YACD,IAAI,mBAAA,IAAI,GAAC,QAAQ,EAAE;gBACjB,mBAAA,IAAI,GAAC,QAAQ,CAAC,KAAK,GAAG,mBAAA,IAAI,GAAC,SAAS,CAAC;aACtC;SACF;QAED,0BAAO,IAAI,GAAC;KACb;;;;IAED,0CAAY;;;IAAZ;QACE,IAAI,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,EAAE;YACtC,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAC;SACrE;aAAM;YACL,IAAI,CAAC,QAAQ,CAAC,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;SACpE;KACF;;;;IAED,sCAAQ;;;IAAR;QACE,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;KACpB;;;;IAED,6CAAe;;;IAAf;QACE,IAAI,CAAC,YAAY,EAAE,CAAC;KACrB;;;;IAED,yCAAW;;;IAAX;QACE,IAAI,IAAI,CAAC,MAAM;YAAE,IAAI,CAAC,OAAO,EAAE,CAAC;KACjC;;;;IAED,yCAAW;;;IAAX;QACE,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;QACxB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;KACzB;;gBA5OF,SAAS,SAAC;oBACT,QAAQ,EAAE,aAAa;oBACvB,0qEAA2C;iBAC5C;;;;gBALQ,gBAAgB;gBAJvB,eAAe;gBAff,SAAS;gBAGF,MAAM;gBAOb,WAAW;gDAqIR,QAAQ,YACR,MAAM,SAAC,gBAAgB;gBAlI1B,YAAY,uBAoIT,QAAQ,YACR,MAAM,SAAC,YAAY;gBAlIf,eAAe,uBAoInB,QAAQ,YACR,MAAM,SAAC,eAAe;;;yBAxHxB,SAAS,SAAC,QAAQ;wBAElB,SAAS,SAAC,OAAO;wBAsBjB,KAAK;0BAWL,KAAK;uBAIL,KAAK;uBAIL,KAAK;2BAGL,KAAK;2BAGL,KAAK;iCAML,KAAK;4BAOL,KAAK;4BAOL,KAAK;wBAIL,KAAK;iCAIL,KAAK;6BAML,KAAK;sCAGL,KAAK;uBAIL,KAAK;yBAGL,KAAK;0BAGL,KAAK;wBAGL,KAAK;sBAGL,KAAK;;IAjENA;QADC,YAAY,EAAE;;wDACC;IAIhBA;QADC,YAAY,EAAE;;qDACF;IAgBbA;QADC,YAAY,EAAE;;+DACS;IAOxBA;QADC,YAAY,EAAE;;0DACI;IAOnBA;QADC,YAAY,EAAE;;0DACI;IAInBA;QADC,YAAY,EAAE;;sDACA;IAIfA;QADC,WAAW,EAAE;;+DACS;IASvBA;QADC,YAAY,EAAE;;oEACc;IA4I/B,0BAAC;CA7OD;;;;;;;ICvBM,UAAU,GAAG,CAAC,mBAAmB,CAAC;AAExC;IAAA;KASC;;;;IAHQ,wBAAO;;;IAAd;QACE,OAAO,EAAE,QAAQ,EAAE,gBAAgB,EAAE,SAAS,EAAE,CAAC,gBAAgB,CAAC,EAAE,CAAC;KACtE;;gBARF,QAAQ,SAAC;oBACR,OAAO,EAAE,CAAC,YAAY,EAAE,YAAY,EAAE,eAAe,EAAE,iBAAiB,CAAC;oBACzE,YAAY,WAAM,UAAU,CAAC;oBAC7B,OAAO,WAAM,UAAU,CAAC;iBACzB;;IAKD,uBAAC;CATD;;;;;;;;;;;;;;"}
