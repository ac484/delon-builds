/**
 * @license ng-alain(cipchk@qq.com) v11.3.1
 * (c) 2020 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common"),require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/cdk/platform"),require("ng-zorro-antd/popover"),require("ng-zorro-antd/core/no-animation"),require("ng-zorro-antd/core/outlet"),require("ng-zorro-antd/button"),require("ng-zorro-antd/core/transition-patch"),require("@delon/theme"),require("@angular/router"),require("@delon/util/config"),require("@angular/cdk/bidi")):"function"==typeof define&&define.amd?define("@delon/abc/onboarding",["exports","@angular/common","@angular/core","rxjs","rxjs/operators","@angular/cdk/platform","ng-zorro-antd/popover","ng-zorro-antd/core/no-animation","ng-zorro-antd/core/outlet","ng-zorro-antd/button","ng-zorro-antd/core/transition-patch","@delon/theme","@angular/router","@delon/util/config","@angular/cdk/bidi"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).delon=e.delon||{},e.delon.abc=e.delon.abc||{},e.delon.abc.onboarding={}),e.ng.common,e.ng.core,e.rxjs,e.rxjs.operators,e.ng.cdk.platform,e["ng-zorro-antd/popover"],e["ng-zorro-antd/core/no-animation"],e["ng-zorro-antd/core/outlet"],e["ng-zorro-antd/button"],e.i7,e.delon.theme,e.ng.router,e.i3$1,e.ng.cdk.bidi)}(this,(function(e,t,n,o,i,r,a,s,c,l,p,u,d,g,h){"use strict";function f(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var m=f(n),v=function(){function e(e,t,o,i){this.el=e,this.doc=t,this.platform=o,this.cdr=i,this.active=0,this.max=0,this.op=new n.EventEmitter,this.running=!1,this.dir="ltr"}return Object.defineProperty(e.prototype,"first",{get:function(){return 0===this.active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this.active===this.max-1},enumerable:!1,configurable:!0}),e.prototype._getDoc=function(){return this.doc},e.prototype._getWin=function(){return this._getDoc().defaultView||window},e.prototype.getLightData=function(){var e=this._getDoc(),t=this._getWin(),n=e.querySelector(this.item.selectors);if(!n)return null;var o=t.pageYOffset||e.documentElement.scrollTop||e.body.scrollTop,i=t.pageXOffset||e.documentElement.scrollLeft||e.body.scrollLeft,r=n.getBoundingClientRect(),a=r.top+o,s=r.left+i,c=a>8&&s>8,l=c?8:0,p=c?16:0;return{top:a-l,left:s-l,width:r.width+p,height:r.height+p,el:n,clientWidth:e.body.clientWidth,clientHeight:e.body.clientHeight}},e.prototype.scroll=function(e){this.prevSelectorEl=e.el;var t=e.top-(e.clientHeight-e.height)/2;this._getWin().scrollTo({top:t}),this.updatePrevElStatus(!0)},e.prototype.updateRunning=function(e){this.running=e,this.cdr.detectChanges(),e||this.updatePosition()},e.prototype.updatePosition=function(){if(this.platform.isBrowser){var e=this.getLightData();if(null!=e){var t=this.el.nativeElement.querySelector(".onboarding__light").style;t.top=e.top+"px",t.left=e.left+"px",t.width=e.width+"px",t.height=e.height+"px",this.updatePrevElStatus(!1),this.scroll(e)}else console.warn("Did not matches selectors ["+this.item.selectors+"]")}},e.prototype.updatePrevElStatus=function(e){this.prevSelectorEl&&this.prevSelectorEl.classList[e?"add":"remove"]("onboarding__light-el")},e.prototype.to=function(e){this.op.emit(e)},e.prototype.handleMask=function(){!0===this.config.maskClosable&&this.to("done")},e.prototype.ngOnDestroy=function(){clearTimeout(this.time),this.updatePrevElStatus(!1)},e}();v.ɵfac=function(e){return new(e||v)(n.ɵɵdirectiveInject(n.ElementRef),n.ɵɵdirectiveInject(t.DOCUMENT,8),n.ɵɵdirectiveInject(r.Platform),n.ɵɵdirectiveInject(n.ChangeDetectorRef))},v.ɵcmp=n.ɵɵngDeclareComponent({version:"11.1.1",type:v,selector:"onboarding",host:{properties:{"class.onboarding":"true","class.onboarding-rtl":"dir === 'rtl'","attr.data-onboarding-active":"active"}},ngImport:m,template:'<div *ngIf="!running && config.mask" class="onboarding__mask" (click)="handleMask()"></div>\n<div\n  *ngIf="item"\n  class="onboarding__light"\n  [class.onboarding__light-hide]="running"\n  [attr.style]="item.lightStyle"\n  nz-popover\n  [nzPopoverTitle]="item.title"\n  [nzPopoverContent]="content"\n  [nzPopoverVisible]="!running"\n  [nzPopoverTrigger]="null"\n  [nzPopoverPlacement]="item.position"\n  [nzPopoverOverlayClassName]="item.className"\n  [nzPopoverOverlayStyle]="{ \'max-width.px\': item.width, direction: dir }"\n  [nzNoAnimation]="true"\n></div>\n<ng-template #content>\n  <ng-container *nzStringTemplateOutlet="item.content">\n    <div [innerHTML]="item.content"></div>\n  </ng-container>\n  <div class="flex-center-between onboarding__footer">\n    <span class="onboarding__total">\n      <ng-container *ngIf="config.showTotal">{{ active + 1 }}/{{ max }}</ng-container>\n    </span>\n    <div class="onboarding__btns">\n      <a *ngIf="!last && item.skip !== null" nz-button nzType="link" (click)="to(\'skip\')" nzSize="small" data-btnType="skip">\n        <ng-container *nzStringTemplateOutlet="item.skip">{{ item.skip }}</ng-container>\n      </a>\n      <a *ngIf="!first && item.prev !== null" nz-button (click)="to(\'prev\')" nzSize="small" data-btnType="prev">\n        <ng-container *nzStringTemplateOutlet="item.prev">{{ item.prev }}</ng-container>\n      </a>\n      <a *ngIf="!last && item.next !== null" nz-button (click)="to(\'next\')" nzType="primary" nzSize="small" data-btnType="next">\n        <ng-container *nzStringTemplateOutlet="item.next">{{ item.next }}</ng-container>\n      </a>\n      <a *ngIf="last && item.done !== null" nz-button (click)="to(\'done\')" nzType="primary" nzSize="small" data-btnType="done">\n        <ng-container *nzStringTemplateOutlet="item.done">{{ item.done }}</ng-container>\n      </a>\n    </div>\n  </div>\n</ng-template>\n',directives:[{type:t.NgIf,selector:"[ngIf]",inputs:["ngIf","ngIfThen","ngIfElse"]},{type:a.NzPopoverDirective,selector:"[nz-popover]",inputs:["nzPopoverTrigger","nzPopoverPlacement","nzPopoverTitle","nzPopoverContent","nz-popover","nzPopoverOrigin","nzPopoverVisible","nzPopoverMouseEnterDelay","nzPopoverMouseLeaveDelay","nzPopoverOverlayClassName","nzPopoverOverlayStyle"],outputs:["nzPopoverVisibleChange"],exportAs:["nzPopover"]},{type:s.NzNoAnimationDirective,selector:"[nzNoAnimation]",inputs:["nzNoAnimation"],exportAs:["nzNoAnimation"]},{type:c.NzStringTemplateOutletDirective,selector:"[nzStringTemplateOutlet]",inputs:["nzStringTemplateOutletContext","nzStringTemplateOutlet"],exportAs:["nzStringTemplateOutlet"]},{type:l.NzButtonComponent,selector:"button[nz-button], a[nz-button]",inputs:["nzBlock","nzGhost","nzSearch","nzLoading","nzDanger","disabled","tabIndex","nzType","nzShape","nzSize"],exportAs:["nzButton"]},{type:p.ɵNzTransitionPatchDirective,selector:"[nz-button], nz-button-group, [nz-icon], [nz-menu-item], [nz-submenu], nz-select-top-control, nz-select-placeholder, nz-input-group",inputs:["hidden"]}],changeDetection:n.ChangeDetectionStrategy.OnPush,encapsulation:n.ViewEncapsulation.None}),("undefined"==typeof ngDevMode||ngDevMode)&&n.ɵsetClassMetadata(v,[{type:n.Component,args:[{selector:"onboarding",templateUrl:"./onboarding.component.html",host:{"[class.onboarding]":"true","[class.onboarding-rtl]":"dir === 'rtl'","[attr.data-onboarding-active]":"active"},preserveWhitespaces:!1,changeDetection:n.ChangeDetectionStrategy.OnPush,encapsulation:n.ViewEncapsulation.None}]}],(function(){return[{type:n.ElementRef},{type:void 0,decorators:[{type:n.Optional},{type:n.Inject,args:[t.DOCUMENT]}]},{type:r.Platform},{type:n.ChangeDetectorRef}]}),null);var y=function(){function e(e,t,n,o,i,r,a,s){this.i18n=e,this.appRef=t,this.resolver=n,this.router=o,this.injector=i,this.doc=r,this.configSrv=a,this.directionality=s,this.active=0,this.running$=null,this._running=!1,this.type=null}return e.prototype._getDoc=function(){return this.doc},Object.defineProperty(e.prototype,"running",{get:function(){return this._running},enumerable:!1,configurable:!0}),e.prototype.attach=function(){var e=this,t=this.compRef=this.resolver.resolveComponentFactory(v).create(this.injector);this.appRef.attachView(t.hostView);var n=t.hostView.rootNodes[0],o=this._getDoc(),i=o.querySelector(".cdk-overlay-container");i?o.body.insertBefore(n,i):o.body.appendChild(n),this.op$=this.compRef.instance.op.subscribe((function(t){switch(t){case"next":e.next();break;case"prev":e.prev();break;default:e.done()}}))},e.prototype.cancelRunning=function(){return this.running$&&(this.running$.unsubscribe(),this.running$=null),this},e.prototype.updateRunning=function(e){return this._running=e,this.compRef.instance.updateRunning(e),this},e.prototype.destroy=function(){this.cancelRunning(),this.compRef&&(this.appRef.detachView(this.compRef.hostView),this.compRef.destroy(),this.op$.unsubscribe())},e.prototype.showItem=function(e){var t=this;void 0===e&&(e=!1);var n=this.config.items,r=Object.assign(Object.assign({position:"bottomLeft",before:o.of(!0),after:o.of(!0)},this.i18n.getData("onboarding")),n[this.active]),a=this.configSrv.get("onboarding").direction||this.directionality.value;Object.assign(this.compRef.instance,{item:r,config:this.config,active:this.active,max:n.length,dir:a});var s=[i.switchMap((function(){return r.url?t.router.navigateByUrl(r.url):o.of(!0)})),i.switchMap((function(){var e="prev"===t.type?r.after:r.before;return"number"==typeof e?o.of(!0).pipe(i.delay(e)):e}))];e||s.push(i.delay(1)),this.updateRunning(!0),this.running$=o.of(!0).pipe(o.pipe.apply(this,s)).subscribe((function(){return t.cancelRunning().updateRunning(!1)}),(function(){return t.done()}))},e.prototype.start=function(e){this.running||(this.destroy(),this.config=Object.assign({items:[],mask:!0,maskClosable:!0,showTotal:!1},e),this.active=0,this.type=null,this.attach(),this.showItem(!0))},e.prototype.next=function(){this._running||this.active+1>=this.config.items.length?this.done():(this.type="next",++this.active,this.showItem())},e.prototype.prev=function(){this._running||this.active-1<0||(this.type="prev",--this.active,this.showItem())},e.prototype.done=function(){this.type="done",this.destroy()},e.prototype.ngOnDestroy=function(){this.destroy()},e}();y.ɵfac=function(e){return new(e||y)(n.ɵɵinject(u.DelonLocaleService),n.ɵɵinject(n.ApplicationRef),n.ɵɵinject(n.ComponentFactoryResolver),n.ɵɵinject(d.Router),n.ɵɵinject(n.Injector),n.ɵɵinject(t.DOCUMENT),n.ɵɵinject(g.AlainConfigService),n.ɵɵinject(h.Directionality,8))},y.ɵprov=n.ɵɵdefineInjectable({token:y,factory:y.ɵfac,providedIn:"root"}),("undefined"==typeof ngDevMode||ngDevMode)&&n.ɵsetClassMetadata(y,[{type:n.Injectable,args:[{providedIn:"root"}]}],(function(){return[{type:u.DelonLocaleService},{type:n.ApplicationRef},{type:n.ComponentFactoryResolver},{type:d.Router},{type:n.Injector},{type:void 0,decorators:[{type:n.Inject,args:[t.DOCUMENT]}]},{type:g.AlainConfigService},{type:h.Directionality,decorators:[{type:n.Optional}]}]}),null);var b=[v],z=function(){};z.ɵmod=n.ɵɵdefineNgModule({type:z}),z.ɵinj=n.ɵɵdefineInjector({factory:function(e){return new(e||z)},imports:[[t.CommonModule,u.DelonLocaleModule,a.NzPopoverModule,c.NzOutletModule,l.NzButtonModule,s.NzNoAnimationModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&n.ɵɵsetNgModuleScope(z,{declarations:[v],imports:[t.CommonModule,u.DelonLocaleModule,a.NzPopoverModule,c.NzOutletModule,l.NzButtonModule,s.NzNoAnimationModule],exports:[v]}),("undefined"==typeof ngDevMode||ngDevMode)&&n.ɵsetClassMetadata(z,[{type:n.NgModule,args:[{imports:[t.CommonModule,u.DelonLocaleModule,a.NzPopoverModule,c.NzOutletModule,l.NzButtonModule,s.NzNoAnimationModule],declarations:b,entryComponents:b,exports:b}]}],null,null),e.OnboardingComponent=v,e.OnboardingModule=z,e.OnboardingService=y,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=onboarding.umd.min.js.map