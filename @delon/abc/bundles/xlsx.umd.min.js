/**
 * @license ng-alain(cipchk@qq.com) v2.0.1
 * (c) 2018 Cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common/http"),require("file-saver"),require("@angular/common"),require("@angular/core"),require("@delon/util")):"function"==typeof define&&define.amd?define("@delon/abc/xlsx",["exports","@angular/common/http","file-saver","@angular/common","@angular/core","@delon/util"],t):t((e.delon=e.delon||{},e.delon.abc=e.delon.abc||{},e.delon.abc.xlsx={}),e.ng.common.http,e.saveAs,e.ng.common,e.ng.core,e.delon.util)}(this,function(e,t,r,o,n,a){"use strict";var i=function y(){this.url="//cdn.bootcss.com/xlsx/0.12.13/xlsx.full.min.js",this.modules=[]},s=function(){return(s=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function c(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),i=[];try{for(;(void 0===t||0<t--)&&!(o=a.next()).done;)i.push(o.value)}catch(s){n={error:s}}finally{try{o&&!o.done&&(r=a["return"])&&r.call(a)}finally{if(n)throw n.error}}return i}function l(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}var u=function(){function e(e,t,r){this.cog=e,this.http=t,this.lazy=r}return e.prototype.init=function(){return this.lazy.load([this.cog.url].concat(this.cog.modules))},e.prototype.read=function(r){var o={};return r.SheetNames.forEach(function(e){var t=r.Sheets[e];o[e]=XLSX.utils.sheet_to_json(t,{header:1})}),o},e.prototype["import"]=function(o,n){var a=this;return void 0===n&&(n="readAsBinaryString"),new Promise(function(r,t){a.init().then(function(){if("string"!=typeof o){var e=new FileReader;e.onload=function(e){var t=XLSX.read(e.target.result,{type:"binary"});r(a.read(t))},e[n](o)}else a.http.request("GET",o,{responseType:"arraybuffer"}).subscribe(function(e){var t=XLSX.read(new Uint8Array(e),{type:"array"});r(a.read(t))},function(e){t(e)})})})},e.prototype["export"]=function(t){return this.init().then(function(){var o=XLSX.utils.book_new();Array.isArray(t.sheets)?t.sheets.forEach(function(e,t){var r=XLSX.utils.aoa_to_sheet(e.data);XLSX.utils.book_append_sheet(o,r,e.name||"Sheet"+(t+1))}):(o.SheetNames=Object.keys(t.sheets),o.Sheets=t.sheets),t.callback&&t.callback(o);var e=XLSX.write(o,s({bookType:"xlsx",bookSST:!1,type:"array"},t.opts));r.saveAs(new Blob([e],{type:"application/octet-stream"}),t.filename||"export.xlsx")})},e.decorators=[{type:n.Injectable}],e.ctorParameters=function(){return[{type:i},{type:t.HttpClient},{type:a.LazyService}]},e}(),p=function(){function e(e){this.srv=e}return e.prototype._click=function(){this.srv["export"](this.data)},e.decorators=[{type:n.Directive,args:[{selector:"[xlsx]"}]}],e.ctorParameters=function(){return[{type:u}]},e.propDecorators={data:[{type:n.Input,args:["xlsx"]}],_click:[{type:n.HostListener,args:["click"]}]},e}(),f=[p],d=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[u,i]}},e.decorators=[{type:n.NgModule,args:[{imports:[o.CommonModule,a.DelonUtilModule],declarations:l(f),exports:l(f)}]}],e}();e.XlsxConfig=i,e.XlsxService=u,e.XlsxDirective=p,e.XlsxModule=d,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=xlsx.umd.min.js.map