/**
 * @license ng-alain(cipchk@qq.com) v11.3.1
 * (c) 2020 cipchk https://ng-alain.com/
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("file-saver"),require("isutf8"),require("@angular/common/http"),require("@delon/util"),require("@angular/common")):"function"==typeof define&&define.amd?define("@delon/abc/xlsx",["exports","@angular/core","file-saver","isutf8","@angular/common/http","@delon/util","@angular/common"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).delon=e.delon||{},e.delon.abc=e.delon.abc||{},e.delon.abc.xlsx={}),e.ng.core,e.saveAs,e.isUtf8,e.ng.common.http,e.delon.util,e.ng.common)}(this,(function(e,t,n,r,o,i,a){"use strict";function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function c(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var l=c(t),s=u(r);function f(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))}function d(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}Object.create;function p(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function y(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}Object.create;var h=function(){function e(e,t,n,r){this.http=e,this.lazy=t,this.ngZone=r,this.cog=n.merge("xlsx",{url:"https://cdn.bootcdn.net/ajax/libs/xlsx/0.16.8/xlsx.full.min.js",modules:["https://cdn.bootcdn.net/ajax/libs/xlsx/0.16.8/cpexcel.min.js"]})}return e.prototype.init=function(){return"undefined"!=typeof XLSX?Promise.resolve([]):this.lazy.load([this.cog.url].concat(this.cog.modules))},e.prototype.read=function(e,t){var n={};return this.ngZone.runOutsideAngular((function(){if("binary"===t.type){var r=new Uint8Array(e);if(!s.default(r))try{e=cptable.utils.decode(936,r),t.type="string"}catch(e){t.type="array"}}var o=XLSX.read(e,t);o.SheetNames.forEach((function(e){var t=o.Sheets[e];n[e]=XLSX.utils.sheet_to_json(t,{header:1})}))})),n},e.prototype.import=function(e,t){var n=this;return void 0===t&&(t="readAsBinaryString"),new Promise((function(t,r){n.init().then((function(){if("string"!=typeof e){var o=new FileReader;o.onload=function(e){n.ngZone.run((function(){return t(n.read(e.target.result,{type:"binary"}))}))},o.readAsArrayBuffer(e)}else n.http.request("GET",e,{responseType:"arraybuffer"}).subscribe((function(e){n.ngZone.run((function(){return t(n.read(new Uint8Array(e),{type:"array"}))}))}),(function(e){r(e)}))})).catch((function(){return r("Unable to load xlsx.js")}))}))},e.prototype.export=function(e){return f(this,void 0,void 0,(function(){var t=this;return d(this,(function(r){return[2,new Promise((function(r,o){t.init().then((function(){t.ngZone.runOutsideAngular((function(){var t=XLSX.utils.book_new();Array.isArray(e.sheets)?e.sheets.forEach((function(e,n){var r=XLSX.utils.aoa_to_sheet(e.data);XLSX.utils.book_append_sheet(t,r,e.name||"Sheet"+(n+1))})):(t.SheetNames=Object.keys(e.sheets),t.Sheets=e.sheets),e.callback&&e.callback(t);var o=XLSX.write(t,Object.assign({bookType:"xlsx",bookSST:!1,type:"array"},e.opts)),i=e.filename||"export.xlsx";n.saveAs(new Blob([o],{type:"application/octet-stream"}),i),r({filename:i,wb:t})}))})).catch((function(e){return o(e)}))}))]}))}))},e.prototype.numberToSchema=function(e){var t="A".charCodeAt(0),n="";do{--e,n=String.fromCharCode(t+e%26)+n,e=e/26>>0}while(e>0);return n},e}();h.ɵfac=function(e){return new(e||h)(t.ɵɵinject(o.HttpClient),t.ɵɵinject(i.LazyService),t.ɵɵinject(i.AlainConfigService),t.ɵɵinject(t.NgZone))},h.ɵprov=t.ɵɵdefineInjectable({token:h,factory:h.ɵfac,providedIn:"root"}),("undefined"==typeof ngDevMode||ngDevMode)&&t.ɵsetClassMetadata(h,[{type:t.Injectable,args:[{providedIn:"root"}]}],(function(){return[{type:o.HttpClient},{type:i.LazyService},{type:i.AlainConfigService},{type:t.NgZone}]}),null);var v=function(){function e(e){this.srv=e}return e.prototype._click=function(){this.srv.export(this.data)},e}();v.ɵfac=function(e){return new(e||v)(t.ɵɵdirectiveInject(h))},v.ɵdir=t.ɵɵngDeclareDirective({version:"11.1.1",type:v,selector:"[xlsx]",inputs:{data:["xlsx","data"]},host:{listeners:{click:"_click()"}},exportAs:["xlsx"],ngImport:l}),("undefined"==typeof ngDevMode||ngDevMode)&&t.ɵsetClassMetadata(v,[{type:t.Directive,args:[{selector:"[xlsx]",exportAs:"xlsx",host:{"(click)":"_click()"}}]}],(function(){return[{type:h}]}),{data:[{type:t.Input,args:["xlsx"]}]});var b=[v],g=function(){};g.ɵmod=t.ɵɵdefineNgModule({type:g}),g.ɵinj=t.ɵɵdefineInjector({factory:function(e){return new(e||g)},imports:[[a.CommonModule,i.DelonUtilModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&t.ɵɵsetNgModuleScope(g,{declarations:[v],imports:[a.CommonModule,i.DelonUtilModule],exports:[v]}),("undefined"==typeof ngDevMode||ngDevMode)&&t.ɵsetClassMetadata(g,[{type:t.NgModule,args:[{imports:[a.CommonModule,i.DelonUtilModule],declarations:y(b),exports:y(b)}]}],null,null),e.XlsxDirective=v,e.XlsxModule=g,e.XlsxService=h,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=xlsx.umd.min.js.map