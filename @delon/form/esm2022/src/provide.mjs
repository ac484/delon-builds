import { ENVIRONMENT_INITIALIZER, NgZone, inject, makeEnvironmentProviders } from '@angular/core';
import { AlainConfigService } from '@delon/util/config';
import { AjvSchemaValidatorFactory, SchemaValidatorFactory } from './validator.factory';
import { WidgetRegistry } from './widget.factory';
import { NzWidgetRegistry } from './widgets/nz-widget.registry';
/**
 * Just only using Standalone widgets
 */
export function provideSFConfig(options) {
    const provides = [
        {
            provide: SchemaValidatorFactory,
            useClass: AjvSchemaValidatorFactory,
            deps: [AlainConfigService, NgZone]
        },
        { provide: WidgetRegistry, useClass: NzWidgetRegistry }
    ];
    if (options?.widgets) {
        provides.push({
            provide: ENVIRONMENT_INITIALIZER,
            multi: true,
            useValue: () => {
                const srv = inject(WidgetRegistry);
                options?.widgets?.forEach(widget => srv.register(widget.KEY, widget.type));
            }
        });
    }
    return makeEnvironmentProviders(provides);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvdmlkZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL2Zvcm0vc3JjL3Byb3ZpZGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUNMLHVCQUF1QixFQUV2QixNQUFNLEVBRU4sTUFBTSxFQUNOLHdCQUF3QixFQUN6QixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUd4RCxPQUFPLEVBQUUseUJBQXlCLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN4RixPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbEQsT0FBTyxFQUFFLGdCQUFnQixFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFPaEU7O0dBRUc7QUFDSCxNQUFNLFVBQVUsZUFBZSxDQUFDLE9BQStDO0lBQzdFLE1BQU0sUUFBUSxHQUEyQztRQUN2RDtZQUNFLE9BQU8sRUFBRSxzQkFBc0I7WUFDL0IsUUFBUSxFQUFFLHlCQUF5QjtZQUNuQyxJQUFJLEVBQUUsQ0FBQyxrQkFBa0IsRUFBRSxNQUFNLENBQUM7U0FDbkM7UUFDRCxFQUFFLE9BQU8sRUFBRSxjQUFjLEVBQUUsUUFBUSxFQUFFLGdCQUFnQixFQUFFO0tBQ3hELENBQUM7SUFDRixJQUFJLE9BQU8sRUFBRSxPQUFPLEVBQUUsQ0FBQztRQUNyQixRQUFRLENBQUMsSUFBSSxDQUFDO1lBQ1osT0FBTyxFQUFFLHVCQUF1QjtZQUNoQyxLQUFLLEVBQUUsSUFBSTtZQUNYLFFBQVEsRUFBRSxHQUFHLEVBQUU7Z0JBQ2IsTUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDO2dCQUNuQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUM3RSxDQUFDO1NBQ0YsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUNELE9BQU8sd0JBQXdCLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDNUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEVOVklST05NRU5UX0lOSVRJQUxJWkVSLFxuICBFbnZpcm9ubWVudFByb3ZpZGVycyxcbiAgTmdab25lLFxuICBQcm92aWRlcixcbiAgaW5qZWN0LFxuICBtYWtlRW52aXJvbm1lbnRQcm92aWRlcnNcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IEFsYWluQ29uZmlnU2VydmljZSB9IGZyb20gJ0BkZWxvbi91dGlsL2NvbmZpZyc7XG5pbXBvcnQgdHlwZSB7IE56U2FmZUFueSB9IGZyb20gJ25nLXpvcnJvLWFudGQvY29yZS90eXBlcyc7XG5cbmltcG9ydCB7IEFqdlNjaGVtYVZhbGlkYXRvckZhY3RvcnksIFNjaGVtYVZhbGlkYXRvckZhY3RvcnkgfSBmcm9tICcuL3ZhbGlkYXRvci5mYWN0b3J5JztcbmltcG9ydCB7IFdpZGdldFJlZ2lzdHJ5IH0gZnJvbSAnLi93aWRnZXQuZmFjdG9yeSc7XG5pbXBvcnQgeyBOeldpZGdldFJlZ2lzdHJ5IH0gZnJvbSAnLi93aWRnZXRzL256LXdpZGdldC5yZWdpc3RyeSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU0ZXaWRnZXRQcm92aWRlQ29uZmlnIHtcbiAgS0VZOiBzdHJpbmc7XG4gIHR5cGU6IE56U2FmZUFueTtcbn1cblxuLyoqXG4gKiBKdXN0IG9ubHkgdXNpbmcgU3RhbmRhbG9uZSB3aWRnZXRzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwcm92aWRlU0ZDb25maWcob3B0aW9ucz86IHsgd2lkZ2V0cz86IFNGV2lkZ2V0UHJvdmlkZUNvbmZpZ1tdIH0pOiBFbnZpcm9ubWVudFByb3ZpZGVycyB7XG4gIGNvbnN0IHByb3ZpZGVzOiBBcnJheTxQcm92aWRlciB8IEVudmlyb25tZW50UHJvdmlkZXJzPiA9IFtcbiAgICB7XG4gICAgICBwcm92aWRlOiBTY2hlbWFWYWxpZGF0b3JGYWN0b3J5LFxuICAgICAgdXNlQ2xhc3M6IEFqdlNjaGVtYVZhbGlkYXRvckZhY3RvcnksXG4gICAgICBkZXBzOiBbQWxhaW5Db25maWdTZXJ2aWNlLCBOZ1pvbmVdXG4gICAgfSxcbiAgICB7IHByb3ZpZGU6IFdpZGdldFJlZ2lzdHJ5LCB1c2VDbGFzczogTnpXaWRnZXRSZWdpc3RyeSB9XG4gIF07XG4gIGlmIChvcHRpb25zPy53aWRnZXRzKSB7XG4gICAgcHJvdmlkZXMucHVzaCh7XG4gICAgICBwcm92aWRlOiBFTlZJUk9OTUVOVF9JTklUSUFMSVpFUixcbiAgICAgIG11bHRpOiB0cnVlLFxuICAgICAgdXNlVmFsdWU6ICgpID0+IHtcbiAgICAgICAgY29uc3Qgc3J2ID0gaW5qZWN0KFdpZGdldFJlZ2lzdHJ5KTtcbiAgICAgICAgb3B0aW9ucz8ud2lkZ2V0cz8uZm9yRWFjaCh3aWRnZXQgPT4gc3J2LnJlZ2lzdGVyKHdpZGdldC5LRVksIHdpZGdldC50eXBlKSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIG1ha2VFbnZpcm9ubWVudFByb3ZpZGVycyhwcm92aWRlcyk7XG59XG4iXX0=